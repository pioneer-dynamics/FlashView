import{d as f,E as v,o as $,e as b,a as g,r as h,b as a,w as r,g as n,t as p,C as P,n as V,m as x}from"./app-CRR-QiEG.js";import{b as S}from"./DialogModal-b7b9cxcX.js";import{_ as B,a as N}from"./TextInput-BSOiuRyo.js";import{_ as T}from"./PrimaryButton-VIj9gzo8.js";import{_ as E}from"./SecondaryButton-DioBU1k-.js";import{_ as F}from"./ConfirmsPasskey-BlHdhd9U.js";const I={class:"mt-4"},U={__name:"ConfirmsPasswordOrPasskey",props:{title:{type:String,default:"Confirm Authority"},content:{type:String,default:"For your security, please confirm your authority to continue."},button:{type:String,default:"Confirm"},mandatory:{type:Boolean,default:!1},seconds:{type:Number,default:0}},emits:["confirmed"],setup(t,{emit:C}){const i=C,l=t,c=f(!1),u=f(null),s=v({password:"",error:"",processing:!1}),m=f(null),_=()=>{c.value=!0,setTimeout(()=>m.value.focus(),250)},k=()=>{axios.get(route("password.confirmation",l.seconds>0?{seconds:l.seconds}:{})).then(e=>{e.data.confirmed&&!l.mandatory?i("confirmed"):u.value.start()})},w=()=>{s.processing=!0,axios.post(route("password.confirm"),{password:s.password}).then(()=>{s.processing=!1,d(),x().then(()=>i("confirmed"))}).catch(e=>{s.processing=!1,s.error=e.response.data.errors.password[0],m.value.focus()})},d=()=>{c.value=!1,s.password="",s.error=""};return(e,o)=>($(),b("span",null,[g("span",{onClick:k},[h(e.$slots,"default")]),a(F,{email:e.$page.props.auth.user.email,ref_key:"passkeyConfirmation",ref:u,onConfirmed:o[0]||(o[0]=y=>i("confirmed")),onCancelled:_},null,8,["email"]),a(S,{show:c.value,onClose:d,ref:"password"},{title:r(()=>[n(p(t.title),1)]),content:r(()=>[n(p(t.content)+" ",1),g("div",I,[a(B,{ref_key:"passwordInput",ref:m,modelValue:s.password,"onUpdate:modelValue":o[1]||(o[1]=y=>s.password=y),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:P(w,["enter"])},null,8,["modelValue"]),a(N,{message:s.error,class:"mt-2"},null,8,["message"])])]),footer:r(()=>[a(E,{onClick:d},{default:r(()=>o[2]||(o[2]=[n(" Cancel ")])),_:1}),a(T,{class:V(["ms-3",{"opacity-25":s.processing}]),disabled:s.processing,onClick:w},{default:r(()=>[n(p(t.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}};export{U as _};
