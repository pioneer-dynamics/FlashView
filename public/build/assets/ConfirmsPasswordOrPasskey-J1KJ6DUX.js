import{r as f,x as v,o as $,d as h,a as g,m as b,b as a,w as r,f as n,t as p,p as P,n as x,l as V}from"./app-CejAU3s6.js";import{a as S}from"./DialogModal-CFk53rsl.js";import{_ as B,a as N}from"./TextInput-DqNhwAG2.js";import{_ as T}from"./PrimaryButton-hhByVcbe.js";import{_ as F}from"./SecondaryButton-977-OQwU.js";import{_ as I}from"./ConfirmsPasskey-SRGVQFFI.js";const K={class:"mt-4"},U={__name:"ConfirmsPasswordOrPasskey",props:{title:{type:String,default:"Confirm Authority"},content:{type:String,default:"For your security, please confirm your authority to continue."},button:{type:String,default:"Confirm"},mandatory:{type:Boolean,default:!1},seconds:{type:Number,default:0}},emits:["confirmed"],setup(t,{emit:_}){const i=_,l=t,c=f(!1),u=f(null),s=v({password:"",error:"",processing:!1}),m=f(null),C=()=>{c.value=!0,setTimeout(()=>m.value.focus(),250)},k=()=>{axios.get(route("password.confirmation",l.seconds>0?{seconds:l.seconds}:{})).then(e=>{e.data.confirmed&&!l.mandatory?i("confirmed"):u.value.start()})},w=()=>{s.processing=!0,axios.post(route("password.confirm"),{password:s.password}).then(()=>{s.processing=!1,d(),V().then(()=>i("confirmed"))}).catch(e=>{s.processing=!1,s.error=e.response.data.errors.password[0],m.value.focus()})},d=()=>{c.value=!1,s.password="",s.error=""};return(e,o)=>($(),h("span",null,[g("span",{onClick:k},[b(e.$slots,"default")]),a(I,{email:e.$page.props.auth.user.email,ref_key:"passkeyConfirmation",ref:u,onConfirmed:o[0]||(o[0]=y=>i("confirmed")),onCancelled:C},null,8,["email"]),a(S,{show:c.value,onClose:d,ref:"password"},{title:r(()=>[n(p(t.title),1)]),content:r(()=>[n(p(t.content)+" ",1),g("div",K,[a(B,{ref_key:"passwordInput",ref:m,modelValue:s.password,"onUpdate:modelValue":o[1]||(o[1]=y=>s.password=y),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:P(w,["enter"])},null,8,["modelValue"]),a(N,{message:s.error,class:"mt-2"},null,8,["message"])])]),footer:r(()=>[a(F,{onClick:d},{default:r(()=>o[2]||(o[2]=[n(" Cancel ")])),_:1}),a(T,{class:x(["ms-3",{"opacity-25":s.processing}]),disabled:s.processing,onClick:w},{default:r(()=>[n(p(t.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}};export{U as _};
