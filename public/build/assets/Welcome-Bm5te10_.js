import{d as F,s as _e,k as Z,o as b,e as T,a as g,n as G,t as U,f as K,I as We,J as Ze,H as Je,r as z,i as re,F as ue,h as et,g as S,Q as L,T as fe,b as B,w as A,c as R,u as v,j as te,B as tt,G as rt,Z as at}from"./app-CXX2NFIA.js";import{_ as he}from"./PrimaryButton-AeWf7PM_.js";import{a as pe,_ as nt}from"./TextInput-ZDTEObhd.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ot="/build/assets/bg-Bk90_pgC.png",it=["value","rows","placeholder"],lt={class:"flex flex-wrap"},dt={class:"ml-6"},ut={__name:"TextAreaInput",props:{modelValue:String,maxLength:{type:Number,default:0},rows:{type:Number,default:3},placeholder:{type:String,default:""}},emits:["update:modelValue"],setup(h,{expose:a}){const e=F(null);return _e(()=>{e.value.hasAttribute("autofocus")&&e.value.focus()}),a({focus:()=>e.value.focus()}),Z(()=>{}),(t,n)=>{var o,l,s,r,i,d,u,c,f,p;return b(),T("span",{onClick:n[1]||(n[1]=()=>e.value.focus()),class:G({"relative border-gray-300 dark:border-gray-700 dark:bg-gray-700 dark:text-gray-200 focus:border-gray-500 dark:focus:border-gray-600 focus:ring-gray-500 dark:focus:ring-gray-600 rounded-md shadow-sm":h.maxLength==0||((l=(o=e.value)==null?void 0:o.value)==null?void 0:l.length)<=h.maxLength,"text-red-500 relative border-red-300 dark:border-red-700 dark:bg-red-700 dark:text-red-200 focus:border-red-500 dark:focus:border-red-600 focus:ring-red-500 dark:focus:ring-red-600 rounded-md shadow-sm bg-red-50":h.maxLength>0&&((r=(s=e.value)==null?void 0:s.value)==null?void 0:r.length)>h.maxLength})},[g("textarea",{ref_key:"input",ref:e,class:G(["w-full border-0 focus:ring-0 -mt-2 -ml-2 -mr-2 mb-2",{"bg-red-50":h.maxLength>0&&((d=(i=e.value)==null?void 0:i.value)==null?void 0:d.length)>h.maxLength}]),value:h.modelValue,rows:h.rows,placeholder:h.placeholder,onInput:n[0]||(n[0]=y=>t.$emit("update:modelValue",y.target.value))},null,42,it),h.maxLength>0?(b(),T("div",{key:0,class:G(["absolute bottom-2 right-6 text-sm",{"text-red-500":((c=(u=e.value)==null?void 0:u.value)==null?void 0:c.length)>h.maxLength}])},[g("div",lt,[n[2]||(n[2]=g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"absolute size-4 ml-1 top-1"},[g("path",{"fill-rule":"evenodd",d:"M4.848 2.771A49.144 49.144 0 0 1 12 2.25c2.43 0 4.817.178 7.152.52 1.978.292 3.348 2.024 3.348 3.97v6.02c0 1.946-1.37 3.678-3.348 3.97a48.901 48.901 0 0 1-3.476.383.39.39 0 0 0-.297.17l-2.755 4.133a.75.75 0 0 1-1.248 0l-2.755-4.133a.39.39 0 0 0-.297-.17 48.9 48.9 0 0 1-3.476-.384c-1.978-.29-3.348-2.024-3.348-3.97V6.741c0-1.946 1.37-3.68 3.348-3.97ZM6.75 8.25a.75.75 0 0 1 .75-.75h9a.75.75 0 0 1 0 1.5h-9a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H7.5Z","clip-rule":"evenodd"})],-1)),g("span",dt,U(h.maxLength-((p=(f=e.value)==null?void 0:f.value)==null?void 0:p.length)),1)])],2)):K("",!0)],2)}}},V=window.crypto||window.msCrypto,m=V.subtle||V.webkitSubtle,X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ee=new Uint8Array(256),ye="06092a864886f70d01050d",W="06092a864886f70d01050c",ge="060960864801650304012e",me="060960864801650304011a",we="0609608648016503040106",be="060960864801650304012a",Ee="0609608648016503040116",xe="0609608648016503040102",ve="060960864801650304012c",Se="0609608648016503040118",Ae="06086086480165030404",Ie="06082a864886f70d020b0500",Ne="06082a864886f70d020a0500",He="06082a864886f70d02090500",De="06082a864886f70d02070500",je="06092a864886f70d010101",Re="06072a8648ce3d0201",Ke="06082a8648ce3d030107",$e="06052b81040022",Le="06052b81040023";class ke{constructor(){for(let a=0;a<X.length;a++)ee[X.charCodeAt(a)]=a}encodeAb(a){const e=new Uint8Array(a),t=e.length;let n="";for(let o=0;o<t;o+=3)n+=X[e[o]>>2],n+=X[(e[o]&3)<<4|e[o+1]>>4],n+=X[(e[o+1]&15)<<2|e[o+2]>>6],n+=X[e[o+2]&63];return t%3===2?n=n.substring(0,n.length-1)+"=":t%3===1&&(n=n.substring(0,n.length-2)+"=="),n}decodeAb(a){const e=a.length;let t=a.length*.75,n=0,o,l,s,r;a[a.length-1]==="="&&(t--,a[a.length-2]==="="&&t--);const i=new ArrayBuffer(t);let d=new Uint8Array(i);for(let u=0;u<e;u+=4)o=ee[a.charCodeAt(u)],l=ee[a.charCodeAt(u+1)],s=ee[a.charCodeAt(u+2)],r=ee[a.charCodeAt(u+3)],d[n++]=o<<2|l>>4,d[n++]=(l&15)<<4|s>>2,d[n++]=(s&3)<<6|r&63;return i}arrayBufferToString(a){if(typeof a!="object")throw new TypeError("Expected input of arrayBuffer to be an ArrayBuffer Object");return new TextDecoder("utf-8").decode(a)}stringToArrayBuffer(a){if(typeof a!="string")throw new TypeError("Expected input of str to be a String");return new TextEncoder("utf-8").encode(a).buffer}arrayBufferToHexString(a){if(typeof a!="object")throw new TypeError("Expected input of arrayBuffer to be an ArrayBuffer Object");const e=new Uint8Array(a);let t="",n;for(let o=0;o<e.byteLength;o++)n=e[o].toString(16),n.length<2&&(n="0"+n),t+=n;return t}hexStringToArrayBuffer(a){if(typeof a!="string")throw new TypeError("Expected input of hexString to be a String");if(a.length%2!==0)throw new RangeError("Expected string to be an even number of characters");const e=new Uint8Array(a.length/2);for(let t=0;t<a.length;t+=2)e[t/2]=parseInt(a.substring(t,t+2),16);return e.buffer}arrayBufferToBase64(a){if(typeof a!="object")throw new TypeError("Expected input of arrayBuffer to be an ArrayBuffer Object");return this.encodeAb(a)}base64ToArrayBuffer(a){if(typeof a!="string")throw new TypeError("Expected input of b64 to be a Base64 String");return this.decodeAb(a)}decimalToHex(a,e){if(e=typeof e<"u"?e:!1,typeof e!="boolean")throw new TypeError("Expected input of unsigned to be a Boolean");let t=null;if(typeof a=="number")return e?(t=a.toString(16),t.length%2?"000"+t:"00"+t):(t=a.toString(16),t.length%2?"0"+t:t);if(typeof a=="string")return t=(a.length/2).toString(16),t.length%2?"0"+t:t;throw new TypeError("Expected input of d to be a Number or String")}addNewLines(a){let e="";for(;a.length>0;)e+=a.substring(0,64)+`\r
`,a=a.substring(64);return e}removeLines(a){return a.replace(/\r?\n|\r/g,"")}toAsn1(a,e,t,n,o,l,s){a=this.arrayBufferToHexString(a),e=this.arrayBufferToHexString(e),t=this.arrayBufferToHexString(t),n=this.decimalToHex(n,!0);const r={};switch(o){case"SHA-512":r.HASH_OID=Ie;break;case"SHA-384":r.HASH_OID=Ne;break;case"SHA-256":r.HASH_OID=He;break;case"SHA-1":r.HASH_OID=De}switch(l){case"AES-GCM":s===256?r.CIPHER_OID=ge:s===192?r.CIPHER_OID=me:s===128&&(r.CIPHER_OID=we);break;case"AES-CBC":s===256?r.CIPHER_OID=be:s===192?r.CIPHER_OID=Ee:s===128&&(r.CIPHER_OID=xe);break;case"AES-CFB":s===256?r.CIPHER_OID=ve:s===192?r.CIPHER_OID=Se:s===128&&(r.CIPHER_OID=Ae)}const i="02"+this.decimalToHex(n.length/2)+n,d="04"+this.decimalToHex(e)+e,u="04"+this.decimalToHex(t)+t,f="04"+(this.decimalToHex(a).length/2===2?"82":"81")+this.decimalToHex(a)+a;r.SEQUENCE_AES_CONTAINER="30"+this.decimalToHex(r.CIPHER_OID+u),r.SEQUENCE_HASH_CONTAINER="30"+this.decimalToHex(r.HASH_OID),r.SEQUENCE_PBKDF2_INNER_CONTAINER="30"+this.decimalToHex(d+i+r.SEQUENCE_HASH_CONTAINER+r.HASH_OID),r.SEQUENCE_PBKDF2_CONTAINER="30"+this.decimalToHex(W+r.SEQUENCE_PBKDF2_INNER_CONTAINER+d+i+r.SEQUENCE_HASH_CONTAINER+r.HASH_OID),r.SEQUENCE_PBES2_INNER_CONTAINER="30"+this.decimalToHex(r.SEQUENCE_PBKDF2_CONTAINER+W+r.SEQUENCE_PBKDF2_INNER_CONTAINER+d+i+r.SEQUENCE_HASH_CONTAINER+r.HASH_OID+r.SEQUENCE_AES_CONTAINER+r.CIPHER_OID+u),r.SEQUENCE_PBES2_CONTAINER="30"+this.decimalToHex(ye+r.SEQUENCE_PBES2_INNER_CONTAINER+r.SEQUENCE_PBKDF2_CONTAINER+W+r.SEQUENCE_PBKDF2_INNER_CONTAINER+d+i+r.SEQUENCE_HASH_CONTAINER+r.HASH_OID+r.SEQUENCE_AES_CONTAINER+r.CIPHER_OID+u);const p=r.SEQUENCE_PBES2_CONTAINER+ye+r.SEQUENCE_PBES2_INNER_CONTAINER+r.SEQUENCE_PBKDF2_CONTAINER+W+r.SEQUENCE_PBKDF2_INNER_CONTAINER+d+i+r.SEQUENCE_HASH_CONTAINER+r.HASH_OID+r.SEQUENCE_AES_CONTAINER+r.CIPHER_OID+u,y=this.decimalToHex(p+f),C="30"+(y.length/2===2?"82":"81")+y+p+f,I=this.hexStringToArrayBuffer(C);let O=this.arrayBufferToBase64(I);return O=this.addNewLines(O),O=`-----BEGIN ENCRYPTED PRIVATE KEY-----\r
`+O+"-----END ENCRYPTED PRIVATE KEY-----",O}fromAsn1(a){a=this.removeLines(a),a=a.replace("-----BEGIN ENCRYPTED PRIVATE KEY-----",""),a=a.replace("-----END ENCRYPTED PRIVATE KEY-----",""),a=this.base64ToArrayBuffer(a);const e={},t=this.arrayBufferToHexString(a);return e.data=t,e.data.includes(ye)&&e.data.includes(W)&&(e.valid=!0),e.saltBegin=e.data.indexOf(W)+28,e.data.includes(ge)?(e.cipher="AES-GCM",e.length=256,e.ivBegin=e.data.indexOf(ge)+24):e.data.includes(me)?(e.cipher="AES-GCM",e.length=192,e.ivBegin=e.data.indexOf(me)+24):e.data.includes(we)?(e.cipher="AES-GCM",e.length=128,e.ivBegin=e.data.indexOf(we)+24):e.data.includes(be)?(e.cipher="AES-CBC",e.length=256,e.ivBegin=e.data.indexOf(be)+24):e.data.includes(Ee)?(e.cipher="AES-CBC",e.length=192,e.ivBegin=e.data.indexOf(Ee)+24):e.data.includes(xe)?(e.cipher="AES-CBC",e.length=128,e.ivBegin=e.data.indexOf(xe)+24):e.data.includes(ve)?(e.cipher="AES-CFB",e.length=256,e.ivBegin=e.data.indexOf(ve)+24):e.data.includes(Se)?(e.cipher="AES-CFB",e.length=192,e.ivBegin=e.data.indexOf(Se)+24):e.data.includes(Ae)&&(e.cipher="AES-CFB",e.length=128,e.ivBegin=e.data.indexOf(Ae)+22),e.data.includes(Ie)?e.hash="SHA-512":e.data.includes(Ne)?e.hash="SHA-384":e.data.includes(He)?e.hash="SHA-256":e.data.includes(De)&&(e.hash="SHA-1"),e.saltLength=parseInt(e.data.substr(e.saltBegin,2),16),e.ivLength=parseInt(e.data.substr(e.ivBegin,2),16),e.salt=e.data.substr(e.saltBegin+2,e.saltLength*2),e.iv=e.data.substr(e.ivBegin+2,e.ivLength*2),e.iterBegin=e.saltBegin+4+e.saltLength*2,e.iterLength=parseInt(e.data.substr(e.iterBegin,2),16),e.iter=parseInt(e.data.substr(e.iterBegin+2,e.iterLength*2),16),e.sequencePadding=e.data.substr(2,2)==="81"?8:10,e.parametersPadding=e.data.substr(2,2)==="81"?12:16,e.sequenceLength=parseInt(e.data.substr(e.sequencePadding,2),16),e.encryptedDataBegin=e.parametersPadding+e.sequenceLength*2,e.encryptedDataPadding=e.data.substr(e.encryptedDataBegin-2,2)==="81"?2:4,e.encryptedDataLength=parseInt(e.data.substr(e.encryptedDataBegin,6),16),e.encryptedData=e.data.substr(e.encryptedDataBegin+e.encryptedDataPadding,e.encryptedDataLength*2),{salt:this.hexStringToArrayBuffer(e.salt),iv:this.hexStringToArrayBuffer(e.iv),cipher:e.cipher,length:e.length,hash:e.hash,iter:e.iter,encryptedData:this.hexStringToArrayBuffer(e.encryptedData)}}cryptoPrivateToPem(a){const e=this;return new Promise((t,n)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="private")throw new TypeError("Expected input to be a CryptoKey Object");m.exportKey("pkcs8",a).then(o=>{const l=e.arrayBufferToBase64(o);let s=e.addNewLines(l);s=`-----BEGIN PRIVATE KEY-----\r
`+s+"-----END PRIVATE KEY-----",t(s)}).catch(o=>{n(o)})})}pemPrivateToCrypto(a,e){const t=this;return typeof e>"u"&&(e={}),e.isExtractable=typeof e.isExtractable<"u"?e.isExtractable:!0,new Promise((n,o)=>{if(typeof a!="string")throw new TypeError("Expected input of pem to be a String");if(typeof e.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");a=a.replace("-----BEGIN PRIVATE KEY-----",""),a=a.replace("-----END PRIVATE KEY-----","");const l=t.removeLines(a),s=t.base64ToArrayBuffer(l),r=t.arrayBufferToHexString(s),i={};if(r.includes(Re)){if(e.name=typeof e.name<"u"?e.name:"ECDH",typeof e.name!="string")throw new TypeError("Expected input of options.name to be a String");let d=null;if(r.includes(Ke)?d="P-256":r.includes($e)?d="P-384":r.includes(Le)&&(d="P-521"),e.name==="ECDH")e.usages=typeof e.usages<"u"?e.usages:["deriveKey","deriveBits"];else if(e.name==="ECDSA")e.usages=typeof e.usages<"u"?e.usages:["sign"];else throw new TypeError("Expected input of options.name is not a valid algorithm name");if(typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");i.name=e.name,i.namedCurve=d}else if(r.includes(je)){if(e.name=typeof e.name<"u"?e.name:"RSA-OAEP",e.hash=typeof e.hash<"u"?e.hash:"SHA-512",typeof e.name!="string")throw new TypeError("Expected input of options.name to be a String");if(typeof e.hash!="string")throw new TypeError("Expected input of options.hash to be a String");if(e.name==="RSA-OAEP")e.usages=typeof e.usages<"u"?e.usages:["decrypt","unwrapKey"];else if(e.name==="RSA-PSS")e.usages=typeof e.usages<"u"?e.usages:["sign"];else throw new TypeError("Expected input of options.name is not a valid algorithm name");if(typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");i.name=e.name,i.hash={},i.hash.name=e.hash}else throw new TypeError("Expected input of pem is not a valid private key");m.importKey("pkcs8",s,i,e.isExtractable,e.usages).then(d=>{n(d)}).catch(d=>{o(d)})})}cryptoPublicToPem(a){const e=this;return new Promise((t,n)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="public")throw new TypeError("Expected input of publicKey to be a CryptoKey Object of type public");m.exportKey("spki",a).then(o=>{const l=e.arrayBufferToBase64(o);let s=e.addNewLines(l);s=`-----BEGIN PUBLIC KEY-----\r
`+s+"-----END PUBLIC KEY-----",t(s)}).catch(o=>{n(o)})})}pemPublicToCrypto(a,e){const t=this;return typeof e>"u"&&(e={}),e.isExtractable=typeof e.isExtractable<"u"?e.isExtractable:!0,new Promise((n,o)=>{if(typeof a!="string")throw new TypeError("Expected input of pem to be a String");if(typeof e.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");a=a.replace("-----BEGIN PUBLIC KEY-----",""),a=a.replace("-----END PUBLIC KEY-----","");const l=t.removeLines(a),s=t.base64ToArrayBuffer(l),r=t.arrayBufferToHexString(s),i={};if(r.includes(Re)){if(e.name=typeof e.name<"u"?e.name:"ECDH",typeof e.name!="string")throw new TypeError("Expected input of options.name to be a String");let d=null;if(r.includes(Ke)?d="P-256":r.includes($e)?d="P-384":r.includes(Le)&&(d="P-521"),e.name==="ECDH")e.usages=typeof e.usages<"u"?e.usages:[];else if(e.name==="ECDSA")e.usages=typeof e.usages<"u"?e.usages:["verify"];else throw new TypeError("Expected input of options.name is not a valid algorithm name");if(typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");i.name=e.name,i.namedCurve=d}else if(r.includes(je)){if(e.name=typeof e.name<"u"?e.name:"RSA-OAEP",e.hash=typeof e.hash<"u"?e.hash:"SHA-512",typeof e.name!="string")throw new TypeError("Expected input of options.name to be a String");if(typeof e.hash!="string")throw new TypeError("Expected input of options.hash to be a String");if(e.name==="RSA-OAEP")e.usages=typeof e.usages<"u"?e.usages:["encrypt","wrapKey"];else if(e.name==="RSA-PSS")e.usages=typeof e.usages<"u"?e.usages:["verify"];else throw new TypeError("Expected input of options.name is not a valid algorithm name");if(typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");i.name=e.name,i.hash={},i.hash.name=e.hash}else throw new TypeError("Expected input of pem is not a valid public key");m.importKey("spki",s,i,e.isExtractable,e.usages).then(d=>{n(d)}).catch(d=>{o(d)})})}cryptoToBase64(a,e){const t=this;let n=null;switch(a.type){case"secret":n="raw";break;case"private":n="pkcs8";break;case"public":n="spki"}return e=typeof e<"u"?e:n,new Promise((o,l)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]")throw new TypeError("Expected input of key to be a CryptoKey Object");if(typeof e!="string")throw new TypeError("Expected input of type to be a String");m.exportKey(n,a).then(s=>{const r=t.arrayBufferToBase64(s);o(r)}).catch(s=>{l(s)})})}base64ToCrypto(a,e){const t=this;return typeof e>"u"&&(e={}),e.name=typeof e.name<"u"?e.name:"AES-GCM",e.isExtractable=typeof e.isExtractable<"u"?e.isExtractable:!0,new Promise((n,o)=>{if(typeof a!="string")throw new TypeError("Expected input of key to be a Base64 String");if(typeof e.name!="string")throw new TypeError("Expected input of options.name to be a String");if(typeof e.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");const l={};if(l.name=e.name,e.name==="AES-GCM"||e.name==="AES-CBC"){if(e.type=typeof e.type<"u"?e.type:"raw",e.length=typeof e.length<"u"?e.length:256,e.usages=typeof e.usages<"u"?e.usages:["encrypt","decrypt","wrapKey","unwrapKey"],typeof e.length!="number")throw new TypeError("Expected input of options.length to be a Number")}else if(e.name==="ECDH"){if(e.type=typeof e.type<"u"?e.type:"pkcs8",e.namedCurve=typeof e.namedCurve<"u"?e.namedCurve:"P-256",e.usages=typeof e.usages<"u"?e.usages:["deriveKey","deriveBits"],typeof e.namedCurve!="string")throw new TypeError("Expected input of options.namedCurve to be a String");l.namedCurve=e.namedCurve}else if(e.name==="ECDSA"){if(e.type=typeof e.type<"u"?e.type:"pkcs8",e.namedCurve=typeof e.namedCurve<"u"?e.namedCurve:"P-256",e.usages=typeof e.usages<"u"?e.usages:["sign"],typeof e.namedCurve!="string")throw new TypeError("Expected input of options.namedCurve to be a String");l.namedCurve=e.namedCurve}else if(e.name==="RSA-OAEP"){if(e.type=typeof e.type<"u"?e.type:"pkcs8",e.hash=typeof e.hash<"u"?e.hash:"SHA-512",e.usages=typeof e.usages<"u"?e.usages:["decrypt","unwrapKey"],typeof e.hash!="string")throw new TypeError("Expected input of options.hash to be a String");l.hash={},l.hash.name=e.hash}else if(e.name==="RSA-PSS"){if(e.type=typeof e.type<"u"?e.type:"pkcs8",e.hash=typeof e.hash<"u"?e.hash:"SHA-512",e.usages=typeof e.usages<"u"?e.usages:["sign"],typeof e.hash!="string")throw new TypeError("Expected input of options.hash to be a String");l.hash={},l.hash.name=e.hash}else throw new TypeError("Expected input of options.name is not a valid algorithm name");if(typeof e.type!="string")throw new TypeError("Expected input of options.type to be a String");if(typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");const s=t.base64ToArrayBuffer(a);m.importKey(e.type,s,l,e.isExtractable,e.usages).then(r=>{n(r)}).catch(r=>{o(r)})})}getRSAKeyPair(a,e,t,n,o){return a=typeof a<"u"?a:2048,e=typeof e<"u"?e:"SHA-512",t=typeof t<"u"?t:"RSA-OAEP",o=typeof o<"u"?o:!0,new Promise((l,s)=>{if(typeof a!="number")throw new TypeError("Expected input of modulusLength to be a Number");if(typeof e!="string")throw new TypeError("Expected input of hash expected to be a String");if(typeof t!="string")throw new TypeError("Expected input of paddingScheme to be a String");if(typeof o!="boolean")throw new TypeError("Expected input of isExtractable to be a Boolean");if(t==="RSA-OAEP")n=typeof n<"u"?n:["encrypt","decrypt","wrapKey","unwrapKey"];else if(t==="RSA-PSS")n=typeof n<"u"?n:["sign","verify"];else throw new TypeError("Expected input of paddingScheme is not a valid padding scheme");if(typeof n!="object")throw new TypeError("Expected input of usages to be an Array");m.generateKey({name:t,modulusLength:a,publicExponent:new Uint8Array([1,0,1]),hash:{name:e}},o,n).then(r=>{l(r)}).catch(r=>{s(r)})})}rsaEncrypt(a,e){const t=this;return new Promise((n,o)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="public")throw new TypeError("Expected input of publicKey to be a CryptoKey Object of type public");if(typeof e!="object")throw new TypeError("Expected input of data to be an ArrayBuffer");m.encrypt({name:"RSA-OAEP"},a,e).then(l=>{const s=t.arrayBufferToBase64(l);n(s)}).catch(l=>{o(l)})})}rsaDecrypt(a,e){const t=this;return new Promise((n,o)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="private")throw new TypeError("Expected input of privateKey to be a CryptoKey Object of type private");if(typeof e!="string")throw new TypeError("Expected input of encryptedData to be a Base64 String");const l=t.base64ToArrayBuffer(e);m.decrypt({name:"RSA-OAEP"},a,l).then(s=>{n(s)}).catch(s=>{o(s)})})}getECKeyPair(a,e,t,n){return a=typeof a<"u"?a:"P-256",e=typeof e<"u"?e:"ECDH",n=typeof n<"u"?n:!0,new Promise((o,l)=>{if(typeof a!="string")throw new TypeError("Expected input of curve to be a String");if(typeof e!="string")throw new TypeError("Expected input of type to be a String");if(typeof n!="boolean")throw new TypeError("Expected input of isExtractable to be a Boolean");if(e==="ECDH")t=typeof t<"u"?t:["deriveKey","deriveBits"];else if(e==="ECDSA")t=typeof t<"u"?t:["sign","verify"];else throw new TypeError("Expected input of type is not a valid algorithm type");if(typeof t!="object")throw new TypeError("Expected input of usages to be an Array");m.generateKey({name:e,namedCurve:a},n,t).then(s=>{o(s)}).catch(s=>{l(s)})})}getPublicKey(a,e){return typeof e>"u"&&(e={}),e.isExtractable=typeof e.isExtractable<"u"?e.isExtractable:!0,new Promise((t,n)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="private")throw new TypeError("Expected input of privateKey must be a CryptoKey Object of type private");if(typeof e.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");m.exportKey("jwk",a).then(o=>{const l={};switch(l.name=a.algorithm.name,a.algorithm.name){case"ECDH":if(delete o.d,o.key_ops=[],e.usages=typeof e.usages<"u"?e.usages:[],typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");l.namedCurve=a.algorithm.namedCurve;break;case"ECDSA":if(delete o.d,o.key_ops=["verify"],e.usages=typeof e.usages<"u"?e.usages:["verify"],typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");l.namedCurve=a.algorithm.namedCurve;break;case"RSA-OAEP":if(delete o.d,delete o.dp,delete o.dq,delete o.p,delete o.q,delete o.qi,o.key_ops=["encrypt","wrapKey"],e.usages=typeof e.usages<"u"?e.usages:["encrypt","wrapKey"],typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");l.hash={},l.hash.name=a.algorithm.hash.name;break;case"RSA-PSS":if(delete o.d,delete o.dp,delete o.dq,delete o.p,delete o.q,delete o.qi,o.key_ops=["verify"],e.usages=typeof e.usages<"u"?e.usages:["verify"],typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");l.hash={},l.hash.name=a.algorithm.hash.name;break;default:throw new TypeError("Expected input of privateKey is not a valid private key")}m.importKey("jwk",o,l,e.isExtractable,e.usages).then(s=>{t(s)}).catch(s=>{n(s)})}).catch(o=>{n(o)})})}encryptPrivateKey(a,e,t,n,o,l){const s=this;return t=typeof t<"u"?t:64e3,n=typeof n<"u"?n:"SHA-512",o=typeof o<"u"?o:"AES-GCM",l=typeof l<"u"?l:256,new Promise((r,i)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="private")throw new TypeError("Expected input of privateKey to be a CryptoKey Object of type private");if(typeof e!="string")throw new TypeError("Expected input of passphrase to be a String");if(typeof t!="number")throw new TypeError("Expected input of iterations to be a Number");if(typeof n!="string")throw new TypeError("Expected input of hash to be a String");if(typeof o!="string")throw new TypeError("Expected input of cipher to be a String");if(typeof l!="number")throw new TypeError("Expected input of length to be a Number");let d=null;switch(o){case"AES-GCM":d=12;break;case"AES-CBC":d=16;break;case"AES-CFB":d=16;break}const u=V.getRandomValues(new Uint8Array(16)),c=V.getRandomValues(new Uint8Array(d)),f=s.stringToArrayBuffer(e);m.importKey("raw",f,{name:"PBKDF2"},!1,["deriveKey"]).then(p=>{m.deriveKey({name:"PBKDF2",salt:u,iterations:t,hash:n},p,{name:o,length:l},!1,["wrapKey"]).then(y=>{m.wrapKey("pkcs8",a,y,{name:o,iv:c,tagLength:128}).then(E=>{const C=s.toAsn1(E,u,c,t,n,o,l);r(C)}).catch(E=>{i(E)})}).catch(y=>{i(y)})}).catch(p=>{i(p)})})}decryptPrivateKey(a,e,t){const n=this;return typeof t>"u"&&(t={}),t.name=typeof t.name<"u"?t.name:"ECDH",t.isExtractable=typeof t.isExtractable<"u"?t.isExtractable:!0,new Promise((o,l)=>{if(typeof a!="string")throw new TypeError("Expected input of encryptedPrivateKey to be a Base64 String");if(typeof e!="string")throw new TypeError("Expected input of passphrase to be a String");if(typeof t.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");const s=this.fromAsn1(a),r={};if(r.name=t.name,t.name==="ECDH"){if(t.namedCurve=typeof t.namedCurve<"u"?t.namedCurve:"P-256",t.usages=typeof t.usages<"u"?t.usages:["deriveKey","deriveBits"],typeof t.namedCurve!="string")throw new TypeError("Expected input of options.namedCurve to be a String");if(typeof t.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");r.namedCurve=t.namedCurve}else if(t.name==="ECDSA"){if(t.namedCurve=typeof t.namedCurve<"u"?t.namedCurve:"P-256",t.usages=typeof t.usages<"u"?t.usages:["sign"],typeof t.namedCurve!="string")throw new TypeError("Expected input of options.namedCurve to be a String");if(typeof t.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");r.namedCurve=t.namedCurve}else if(t.name==="RSA-OAEP"){if(t.hash=typeof t.hash<"u"?t.hash:"SHA-512",t.usages=typeof t.usages<"u"?t.usages:["decrypt","unwrapKey"],typeof t.hash!="string")throw new TypeError("Expected input of options.hash to be a String");if(typeof t.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");r.hash={},r.hash.name=t.hash}else if(t.name==="RSA-PSS"){if(t.hash=typeof t.hash<"u"?t.hash:"SHA-512",t.usages=typeof t.usages<"u"?t.usages:["sign"],typeof t.hash!="string")throw new TypeError("Expected input of options.hash to be a String");if(typeof t.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");r.hash={},r.hash.name=t.hash}else throw new TypeError("Expected input of encryptedPrivateKey is not a valid encrypted private key");const i=n.stringToArrayBuffer(e);m.importKey("raw",i,{name:"PBKDF2"},!1,["deriveKey"]).then(d=>{m.deriveKey({name:"PBKDF2",salt:s.salt,iterations:s.iter,hash:s.hash},d,{name:s.cipher,length:s.length},!1,["unwrapKey"]).then(u=>{m.unwrapKey("pkcs8",s.encryptedData,u,{name:s.cipher,iv:s.iv,tagLength:128},r,t.isExtractable,t.usages).then(c=>{o(c)}).catch(c=>{l(c)})}).catch(u=>{l(u)})}).catch(d=>{l(d)})})}keyAgreement(a,e,t){return typeof t>"u"&&(t={}),t.bitLength=typeof t.bitLength<"u"?t.bitLength:256,t.hkdfHash=typeof t.hkdfHash<"u"?t.hkdfHash:"SHA-512",t.hkdfSalt=typeof t.hkdfSalt<"u"?t.hkdfSalt:new Uint8Array,t.hkdfInfo=typeof t.hkdfInfo<"u"?t.hkdfInfo:new Uint8Array,t.cipher=typeof t.cipher<"u"?t.cipher:"AES-GCM",t.length=typeof t.length<"u"?t.length:256,t.usages=typeof t.usages<"u"?t.usages:["encrypt","decrypt","unwrapKey","wrapKey"],t.isExtractable=typeof t.isExtractable<"u"?t.isExtractable:!0,new Promise((n,o)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="private")throw new TypeError("Expected input of privateKey to be a CryptoKey Object of type private");if(Object.prototype.toString.call(e)!=="[object CryptoKey]"&&e.type!=="public")throw new TypeError("Expected input of publicKey to be a CryptoKey Object of type public");if(typeof t.bitLength!="number")throw new TypeError("Expected input of options.bitLength to be a Number");if(typeof t.hkdfHash!="string")throw new TypeError("Expected input of options.hkdfHash to be a String");if(typeof t.hkdfSalt!="object")throw new TypeError("Expected input of options.hkdfSalt to be an ArrayBuffer");if(typeof t.hkdfInfo!="object")throw new TypeError("Expected input of options.hkdfInfo to be an ArrayBuffer");if(typeof t.cipher!="string")throw new TypeError("Expected input of options.cipher to be a String");if(typeof t.length!="number")throw new TypeError("Expected input of options.length to be a Number");if(typeof t.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");if(typeof t.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");m.deriveBits({name:"ECDH",namedCurve:e.algorithm.namedCurve,public:e},a,t.bitLength).then(l=>{m.importKey("raw",l,{name:"HKDF"},!1,["deriveKey"]).then(s=>{m.deriveKey({name:"HKDF",hash:{name:t.hkdfHash},salt:t.hkdfSalt,info:t.hkdfInfo},s,{name:t.cipher,length:t.length},t.isExtractable,t.usages).then(r=>{n(r)}).catch(r=>{o(r)})}).catch(s=>{o(s)})}).catch(l=>{o(l)})})}getSharedKey(a,e){return a=typeof a<"u"?a:256,typeof e>"u"&&(e={}),e.cipher=typeof e.cipher<"u"?e.cipher:"AES-GCM",e.usages=typeof e.usages<"u"?e.usages:["encrypt","decrypt","wrapKey","unwrapKey"],e.isExtractable=typeof e.isExtractable<"u"?e.isExtractable:!0,new Promise((t,n)=>{if(typeof a!="number")throw new TypeError("Expected input of length to be a Number");if(typeof e.cipher!="string")throw new TypeError("Expected input of options.cipher expected to be a String");if(typeof e.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");if(typeof e.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable expected to be a Boolean");m.generateKey({name:e.cipher,length:a},e.isExtractable,e.usages).then(o=>{t(o)}).catch(o=>{n(o)})})}encryptKey(a,e){const t=this;return new Promise((n,o)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]")throw new TypeError("Expected input of wrappingKey to be a CryptoKey Object");if(Object.prototype.toString.call(e)!=="[object CryptoKey]")throw new TypeError("Expected input of key to be a CryptoKey Object");let l=null;switch(e.type){case"secret":l="raw";break;case"private":l="pkcs8";break;case"public":l="spki"}if(a.type==="secret"){let s=null;if(a.algorithm.name==="AES-GCM")s=V.getRandomValues(new Uint8Array(12));else if(a.algorithm.name==="AES-CBC")s=V.getRandomValues(new Uint8Array(16));else throw new TypeError("Cipher mode of the wrappingKey is not supported");m.wrapKey(l,e,a,{name:a.algorithm.name,iv:s,tagLength:128}).then(r=>{const i=t.arrayBufferToBase64(s)+t.arrayBufferToBase64(r);n(i)}).catch(r=>{o(r)})}else if(a.algorithm.name==="RSA-OAEP"){if(a.type!=="public")throw new TypeError("Expected input of wrappingKey to be a CryptoKey Object of type public");m.wrapKey(l,e,a,{name:"RSA-OAEP",hash:{name:a.algorithm.hash.name}}).then(s=>{const r=t.arrayBufferToBase64(s);n(r)}).catch(s=>{o(s)})}else throw new TypeError("Expected input of wrappingKey is not a supported key")})}decryptKey(a,e,t){const n=this;return typeof t>"u"&&(t={}),t.name=typeof t.name<"u"?t.name:"AES-GCM",t.isExtractable=typeof t.isExtractable<"u"?t.isExtractable:!0,new Promise((o,l)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]")throw new TypeError("Expected input of unwrappingKey to be a CryptoKey Object");if(typeof e!="string")throw new TypeError("Expected input of encryptedKey to be a Base64 String");if(typeof t.name!="string")throw new TypeError("Expected input of options.name to be a String");if(typeof t.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");const s={};if(s.name=t.name,t.name==="AES-GCM"||t.name==="AES-CBC"){if(t.type=typeof t.type<"u"?t.type:"raw",t.length=typeof t.length<"u"?t.length:256,t.usages=typeof t.usages<"u"?t.usages:["encrypt","decrypt","wrapKey","unwrapKey"],typeof t.length!="number")throw new TypeError("Expected input of options.length to be a Number")}else if(t.name==="ECDH"){if(t.type=typeof t.type<"u"?t.type:"pkcs8",t.namedCurve=typeof t.namedCurve<"u"?t.namedCurve:"P-256",t.usages=typeof t.usages<"u"?t.usages:["deriveKey","deriveBits"],typeof t.namedCurve!="string")throw new TypeError("Expected input of options.namedCurve to be a String");s.namedCurve=t.namedCurve}else if(t.name==="ECDSA"){if(t.type=typeof t.type<"u"?t.type:"pkcs8",t.namedCurve=typeof t.namedCurve<"u"?t.namedCurve:"P-256",t.usages=typeof t.usages<"u"?t.usages:["sign"],typeof t.namedCurve!="string")throw new TypeError("Expected input of options.namedCurve to be a String");s.namedCurve=t.namedCurve}else if(t.name==="RSA-OAEP"){if(t.type=typeof t.type<"u"?t.type:"pkcs8",t.hash=typeof t.hash<"u"?t.hash:"SHA-512",t.usages=typeof t.usages<"u"?t.usages:["decrypt","unwrapKey"],typeof t.hash!="string")throw new TypeError("Expected input of options.hash to be a String");s.hash={},s.hash.name=t.hash}else if(t.name==="RSA-PSS"){if(t.type=typeof t.type<"u"?t.type:"pkcs8",t.hash=typeof t.hash<"u"?t.hash:"SHA-512",t.usages=typeof t.usages<"u"?t.usages:["sign"],typeof t.hash!="string")throw new TypeError("Expected input of options.hash to be a String");s.hash={},s.hash.name=t.hash}else throw new TypeError("Expected input of options.name is not a valid algorithm name");if(typeof t.type!="string")throw new TypeError("Expected input of options.type to be a String");if(typeof t.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");if(a.type==="secret"){let r=null,i=null;if(a.algorithm.name==="AES-GCM")r=e.substring(0,16),i=e.substring(16);else if(a.algorithm.name==="AES-CBC")r=e.substring(0,24),i=e.substring(24);else throw new TypeError("Cipher mode of the wrappingKey is not supported");const d=n.base64ToArrayBuffer(r),u=n.base64ToArrayBuffer(i);m.unwrapKey(t.type,u,a,{name:a.algorithm.name,iv:d,tagLength:128},s,t.isExtractable,t.usages).then(c=>{o(c)}).catch(c=>{l(c)})}else if(a.algorithm.name==="RSA-OAEP"){if(a.type!=="private")throw new TypeError("Expected input of unwrappingKey to be a CryptoKey Object of type private");const r=n.base64ToArrayBuffer(e);m.unwrapKey(t.type,r,a,{name:"RSA-OAEP",modulusLength:a.algorithm.modulusLength,publicExponent:new Uint8Array([1,0,1]),hash:{name:a.algorithm.hash.name}},s,t.isExtractable,t.usages).then(i=>{o(i)}).catch(i=>{l(i)})}else throw new TypeError("Expected input of unwrappingKey is not a supported key")})}signKey(a,e,t){const n=this;return typeof t>"u"&&(t={}),new Promise((o,l)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="private")throw new TypeError("Expected input of privateKey to be a CryptoKey Object of type private");if(Object.prototype.toString.call(e)!=="[object CryptoKey]")throw new TypeError("Expected input of key to be a CryptoKey Object");m.exportKey("raw",e).then(s=>{if(a.algorithm.name==="ECDSA"){if(t.hash=typeof t.hash<"u"?t.hash:"SHA-512",typeof t.hash!="string")throw new TypeError("Expected input of options.hash to be a String");m.sign({name:"ECDSA",hash:{name:t.hash}},a,s).then(r=>{const i=n.arrayBufferToBase64(r);o(i)}).catch(r=>{l(r)})}else if(a.algorithm.name==="RSA-PSS"){if(t.saltLength=typeof t.saltLength<"u"?t.saltLength:128,typeof t.saltLength!="number")throw new TypeError("Expected input of options.saltLength to be a Number");m.sign({name:"RSA-PSS",saltLength:t.saltLength},a,s).then(r=>{const i=n.arrayBufferToBase64(r);o(i)}).catch(r=>{l(r)})}else throw new TypeError("Expected input of privateKey is not a valid private key")}).catch(s=>{l(s)})})}verifyKey(a,e,t,n){const o=this;return typeof n>"u"&&(n={}),new Promise((l,s)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="public")throw new TypeError("Expected input of publicKey to be a CryptoKey Object of type public");if(Object.prototype.toString.call(e)!=="[object CryptoKey]")throw new TypeError("Expected input of key to be a CryptoKey Object");if(typeof t!="string")throw new TypeError("Expected input of signature to be a Base64 String");const r=o.base64ToArrayBuffer(t);m.exportKey("raw",e).then(i=>{if(a.algorithm.name==="ECDSA"){if(n.hash=typeof n.hash<"u"?n.hash:"SHA-512",typeof n.hash!="string")throw new TypeError("Expected input of options.hash to be a String");m.verify({name:"ECDSA",hash:{name:n.hash}},a,r,i).then(d=>{l(d)}).catch(d=>{s(d)})}else if(a.algorithm.name==="RSA-PSS")m.verify({name:"RSA-PSS",saltLength:128},a,r,i).then(d=>{l(d)}).catch(d=>{s(d)});else throw new TypeError("Expected input of publicKey is not a valid public key")}).catch(i=>{s(i)})})}sign(a,e,t){const n=this;return typeof t>"u"&&(t={}),new Promise((o,l)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="private")throw new TypeError("Expected input of privateKey to be a CryptoKey Object of type private");if(typeof e!="object")throw new TypeError("Expected input of data to be an ArrayBuffer");if(a.algorithm.name==="ECDSA"){if(t.hash=typeof t.hash<"u"?t.hash:"SHA-512",typeof t.hash!="string")throw new TypeError("Expected input of options.hash to be a String");m.sign({name:"ECDSA",hash:{name:t.hash}},a,e).then(s=>{const r=n.arrayBufferToBase64(s);o(r)}).catch(s=>{l(s)})}else if(a.algorithm.name==="RSA-PSS"){if(t.saltLength=typeof t.saltLength<"u"?t.saltLength:128,typeof t.saltLength!="number")throw new TypeError("Expected input of options.saltLength to be a Number");m.sign({name:"RSA-PSS",saltLength:t.saltLength},a,e).then(s=>{const r=n.arrayBufferToBase64(s);o(r)}).catch(s=>{l(s)})}else throw new TypeError("Expected input of privateKey is not a valid private key")})}verify(a,e,t,n){const o=this;return typeof n>"u"&&(n={}),new Promise((l,s)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="public")throw new TypeError("Expected input of publicKey to be a CryptoKey Object of type public");if(typeof e!="object")throw new TypeError("Expected input of data to be an ArrayBuffer");if(typeof t!="string")throw new TypeError("Expected input of signature to be a Base64 String");const r=o.base64ToArrayBuffer(t);if(a.algorithm.name==="ECDSA"){if(n.hash=typeof n.hash<"u"?n.hash:"SHA-512",typeof n.hash!="string")throw new TypeError("Expected input of options.hash to be a String");m.verify({name:"ECDSA",hash:{name:n.hash}},a,r,e).then(i=>{l(i)}).catch(i=>{s(i)})}else if(a.algorithm.name==="RSA-PSS")m.verify({name:"RSA-PSS",saltLength:128},a,r,e).then(i=>{l(i)}).catch(i=>{s(i)});else throw new TypeError("Expected input of publicKey is not a valid public key")})}encrypt(a,e){const t=this;return new Promise((n,o)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="secret")throw new TypeError("Expected input of sharedKey to be a CryptoKey Object");if(typeof e!="object")throw new TypeError("Expected input of data to be an ArrayBuffer");let l=null;if(a.algorithm.name==="AES-GCM")l=V.getRandomValues(new Uint8Array(12));else if(a.algorithm.name==="AES-CBC")l=V.getRandomValues(new Uint8Array(16));else throw new TypeError("Cipher mode of the sharedKey is not supported");m.encrypt({name:a.algorithm.name,iv:l,tagLength:128},a,e).then(s=>{const r=t.arrayBufferToBase64(l),i=t.arrayBufferToBase64(s);n(r+i)}).catch(s=>{o(s)})})}decrypt(a,e,t){const n=this;return typeof t>"u"&&(t={}),t.cipher=typeof t.cipher<"u"?t.cipher:"AES-GCM",new Promise((o,l)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]"&&a.type!=="secret")throw new TypeError("Expected input of sharedKey to be a CryptoKey Object");if(typeof e!="string")throw new TypeError("Expected input of encryptedData to be a String");if(typeof t.cipher!="string")throw new TypeError("Expected input of options.cipher to be a String");let s=null,r=null;if(t.cipher==="AES-GCM")s=e.substring(0,16),r=e.substring(16);else if(t.cipher==="AES-CBC")s=e.substring(0,24),r=e.substring(24);else throw new TypeError("Cipher mode of the sharedKey is not supported");const i=n.base64ToArrayBuffer(s),d=n.base64ToArrayBuffer(r);m.decrypt({name:t.cipher,iv:i,tagLength:128},a,d).then(u=>{o(u)}).catch(u=>{l(u)})})}derivePassphraseKey(a,e,t,n){const o=this;return t=typeof t<"u"?t:64e3,typeof n>"u"&&(n={}),n.hash=typeof n.hash<"u"?n.hash:"SHA-512",n.length=typeof n.length<"u"?n.length:256,n.cipher=typeof n.cipher<"u"?n.cipher:"AES-GCM",n.usages=typeof n.usages<"u"?n.usages:["encrypt","decrypt","wrapKey","unwrapKey"],n.isExtractable=typeof n.isExtractable<"u"?n.isExtractable:!0,new Promise((l,s)=>{if(typeof a!="string")throw new TypeError("Expected input of passphrase to be a String");if(typeof e!="object")throw new TypeError("Expected input of salt to be an ArrayBuffer");if(typeof t!="number")throw new TypeError("Expected input of iterations to be a Number");if(typeof n.hash!="string")throw new TypeError("Expected input of options.hash to be a String");if(typeof n.length!="number")throw new TypeError("Expected input of options.length to be a Number");if(typeof n.cipher!="string")throw new TypeError("Expected input of options.cipher to be a String");if(typeof n.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");if(typeof n.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");const r=o.stringToArrayBuffer(a);m.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]).then(i=>{m.deriveKey({name:"PBKDF2",salt:e,iterations:t,hash:{name:n.hash}},i,{name:n.cipher,length:n.length},n.isExtractable,n.usages).then(d=>{l(d)}).catch(d=>{s(d)})}).catch(i=>{s(i)})})}hashPassphrase(a,e,t,n){const o=this;return t=typeof t<"u"?t:64e3,typeof n>"u"&&(n={}),n.hash=typeof n.hash<"u"?n.hash:"SHA-512",n.length=typeof n.length<"u"?n.length:256,n.cipher=typeof n.cipher<"u"?n.cipher:"AES-GCM",n.usages=typeof n.usages<"u"?n.usages:["encrypt","decrypt","wrapKey","unwrapKey"],n.isExtractable=typeof n.isExtractable<"u"?n.isExtractable:!0,new Promise((l,s)=>{if(typeof a!="string")throw new TypeError("Expected input of passphrase to be a String");if(typeof e!="object")throw new TypeError("Expected input of salt to be an ArrayBuffer");if(typeof t!="number")throw new TypeError("Expected input of iterations to be a Number");if(typeof n.hash!="string")throw new TypeError("Expected input of options.hash to be a String");if(typeof n.length!="number")throw new TypeError("Expected input of options.length to be a Number");if(typeof n.cipher!="string")throw new TypeError("Expected input of options.cipher to be a String");if(typeof n.usages!="object")throw new TypeError("Expected input of options.usages to be an Array");if(typeof n.isExtractable!="boolean")throw new TypeError("Expected input of options.isExtractable to be a Boolean");o.derivePassphraseKey(a,e,t,n).then(r=>{m.exportKey("raw",r).then(i=>{const d=o.arrayBufferToHexString(i);l(d)}).catch(i=>{s(i)})}).catch(r=>{s(r)})})}getFingerprint(a,e){const t=this;return typeof e>"u"&&(e={}),e.hash=typeof hash<"u"?hash:"SHA-512",e.isBuffer=typeof e.isBuffer<"u"?e.isBuffer:!1,new Promise((n,o)=>{if(Object.prototype.toString.call(a)!=="[object CryptoKey]")throw new TypeError("Expected input of key to be a CryptoKey Object");if(typeof e.hash!="string")throw new TypeError("Expected input of options.hash to be a String");if(typeof e.isBuffer!="boolean")throw new TypeError("Expected input of options.isBuffer to be a Boolean");let l=null;switch(a.type){case"secret":l="raw";break;case"private":l="pkcs8";break;case"public":l="spki"}m.exportKey(l,a).then(s=>{m.digest({name:e.hash},s).then(r=>{if(e.isBuffer)n(r);else{const i=t.arrayBufferToHexString(r);n(i)}}).catch(r=>{o(r)})}).catch(s=>{o(s)})})}getRandomBytes(a){return a=typeof a<"u"?a:16,new Promise((e,t)=>{if(typeof a!="number")throw new TypeError("Expected input of size to be a Number");const n=V.getRandomValues(new Uint8Array(a));e(n)})}}var ae={exports:{}},ct=ae.exports,qe;function ft(){return qe||(qe=1,function(h){(function(a,e,t){function n(r){var i=this,d=s();i.next=function(){var u=2091639*i.s0+i.c*23283064365386963e-26;return i.s0=i.s1,i.s1=i.s2,i.s2=u-(i.c=u|0)},i.c=1,i.s0=d(" "),i.s1=d(" "),i.s2=d(" "),i.s0-=d(r),i.s0<0&&(i.s0+=1),i.s1-=d(r),i.s1<0&&(i.s1+=1),i.s2-=d(r),i.s2<0&&(i.s2+=1),d=null}function o(r,i){return i.c=r.c,i.s0=r.s0,i.s1=r.s1,i.s2=r.s2,i}function l(r,i){var d=new n(r),u=i&&i.state,c=d.next;return c.int32=function(){return d.next()*4294967296|0},c.double=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.quick=c,u&&(typeof u=="object"&&o(u,d),c.state=function(){return o(d,{})}),c}function s(){var r=4022871197,i=function(d){d=String(d);for(var u=0;u<d.length;u++){r+=d.charCodeAt(u);var c=.02519603282416938*r;r=c>>>0,c-=r,c*=r,r=c>>>0,c-=r,r+=c*4294967296}return(r>>>0)*23283064365386963e-26};return i}e&&e.exports?e.exports=l:this.alea=l})(ct,h)}(ae)),ae.exports}var ne={exports:{}},ht=ne.exports,Ue;function pt(){return Ue||(Ue=1,function(h){(function(a,e,t){function n(s){var r=this,i="";r.x=0,r.y=0,r.z=0,r.w=0,r.next=function(){var u=r.x^r.x<<11;return r.x=r.y,r.y=r.z,r.z=r.w,r.w^=r.w>>>19^u^u>>>8},s===(s|0)?r.x=s:i+=s;for(var d=0;d<i.length+64;d++)r.x^=i.charCodeAt(d)|0,r.next()}function o(s,r){return r.x=s.x,r.y=s.y,r.z=s.z,r.w=s.w,r}function l(s,r){var i=new n(s),d=r&&r.state,u=function(){return(i.next()>>>0)/4294967296};return u.double=function(){do var c=i.next()>>>11,f=(i.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},u.int32=i.next,u.quick=u,d&&(typeof d=="object"&&o(d,i),u.state=function(){return o(i,{})}),u}e&&e.exports?e.exports=l:this.xor128=l})(ht,h)}(ne)),ne.exports}var se={exports:{}},yt=se.exports,Me;function gt(){return Me||(Me=1,function(h){(function(a,e,t){function n(s){var r=this,i="";r.next=function(){var u=r.x^r.x>>>2;return r.x=r.y,r.y=r.z,r.z=r.w,r.w=r.v,(r.d=r.d+362437|0)+(r.v=r.v^r.v<<4^(u^u<<1))|0},r.x=0,r.y=0,r.z=0,r.w=0,r.v=0,s===(s|0)?r.x=s:i+=s;for(var d=0;d<i.length+64;d++)r.x^=i.charCodeAt(d)|0,d==i.length&&(r.d=r.x<<10^r.x>>>4),r.next()}function o(s,r){return r.x=s.x,r.y=s.y,r.z=s.z,r.w=s.w,r.v=s.v,r.d=s.d,r}function l(s,r){var i=new n(s),d=r&&r.state,u=function(){return(i.next()>>>0)/4294967296};return u.double=function(){do var c=i.next()>>>11,f=(i.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},u.int32=i.next,u.quick=u,d&&(typeof d=="object"&&o(d,i),u.state=function(){return o(i,{})}),u}e&&e.exports?e.exports=l:this.xorwow=l})(yt,h)}(se)),se.exports}var oe={exports:{}},mt=oe.exports,Fe;function wt(){return Fe||(Fe=1,function(h){(function(a,e,t){function n(s){var r=this;r.next=function(){var d=r.x,u=r.i,c,f;return c=d[u],c^=c>>>7,f=c^c<<24,c=d[u+1&7],f^=c^c>>>10,c=d[u+3&7],f^=c^c>>>3,c=d[u+4&7],f^=c^c<<7,c=d[u+7&7],c=c^c<<13,f^=c^c<<9,d[u]=f,r.i=u+1&7,f};function i(d,u){var c,f=[];if(u===(u|0))f[0]=u;else for(u=""+u,c=0;c<u.length;++c)f[c&7]=f[c&7]<<15^u.charCodeAt(c)+f[c+1&7]<<13;for(;f.length<8;)f.push(0);for(c=0;c<8&&f[c]===0;++c);for(c==8?f[7]=-1:f[c],d.x=f,d.i=0,c=256;c>0;--c)d.next()}i(r,s)}function o(s,r){return r.x=s.x.slice(),r.i=s.i,r}function l(s,r){s==null&&(s=+new Date);var i=new n(s),d=r&&r.state,u=function(){return(i.next()>>>0)/4294967296};return u.double=function(){do var c=i.next()>>>11,f=(i.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},u.int32=i.next,u.quick=u,d&&(d.x&&o(d,i),u.state=function(){return o(i,{})}),u}e&&e.exports?e.exports=l:this.xorshift7=l})(mt,h)}(oe)),oe.exports}var ie={exports:{}},bt=ie.exports,Ge;function Et(){return Ge||(Ge=1,function(h){(function(a,e,t){function n(s){var r=this;r.next=function(){var d=r.w,u=r.X,c=r.i,f,p;return r.w=d=d+1640531527|0,p=u[c+34&127],f=u[c=c+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=u[c]=p^f,r.i=c,p+(d^d>>>16)|0};function i(d,u){var c,f,p,y,E,C=[],I=128;for(u===(u|0)?(f=u,u=null):(u=u+"\0",f=0,I=Math.max(I,u.length)),p=0,y=-32;y<I;++y)u&&(f^=u.charCodeAt((y+32)%u.length)),y===0&&(E=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,y>=0&&(E=E+1640531527|0,c=C[y&127]^=f+E,p=c==0?p+1:0);for(p>=128&&(C[(u&&u.length||0)&127]=-1),p=127,y=4*128;y>0;--y)f=C[p+34&127],c=C[p=p+1&127],f^=f<<13,c^=c<<17,f^=f>>>15,c^=c>>>12,C[p]=f^c;d.w=E,d.X=C,d.i=p}i(r,s)}function o(s,r){return r.i=s.i,r.w=s.w,r.X=s.X.slice(),r}function l(s,r){s==null&&(s=+new Date);var i=new n(s),d=r&&r.state,u=function(){return(i.next()>>>0)/4294967296};return u.double=function(){do var c=i.next()>>>11,f=(i.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},u.int32=i.next,u.quick=u,d&&(d.X&&o(d,i),u.state=function(){return o(i,{})}),u}e&&e.exports?e.exports=l:this.xor4096=l})(bt,h)}(ie)),ie.exports}var le={exports:{}},xt=le.exports,Ve;function vt(){return Ve||(Ve=1,function(h){(function(a,e,t){function n(s){var r=this,i="";r.next=function(){var u=r.b,c=r.c,f=r.d,p=r.a;return u=u<<25^u>>>7^c,c=c-f|0,f=f<<24^f>>>8^p,p=p-u|0,r.b=u=u<<20^u>>>12^c,r.c=c=c-f|0,r.d=f<<16^c>>>16^p,r.a=p-u|0},r.a=0,r.b=0,r.c=-1640531527,r.d=1367130551,s===Math.floor(s)?(r.a=s/4294967296|0,r.b=s|0):i+=s;for(var d=0;d<i.length+20;d++)r.b^=i.charCodeAt(d)|0,r.next()}function o(s,r){return r.a=s.a,r.b=s.b,r.c=s.c,r.d=s.d,r}function l(s,r){var i=new n(s),d=r&&r.state,u=function(){return(i.next()>>>0)/4294967296};return u.double=function(){do var c=i.next()>>>11,f=(i.next()>>>0)/4294967296,p=(c+f)/(1<<21);while(p===0);return p},u.int32=i.next,u.quick=u,d&&(typeof d=="object"&&o(d,i),u.state=function(){return o(i,{})}),u}e&&e.exports?e.exports=l:this.tychei=l})(xt,h)}(le)),le.exports}var de={exports:{}},St=de.exports,Qe;function At(){return Qe||(Qe=1,function(h){(function(a,e,t){var n=256,o=6,l=52,s="random",r=t.pow(n,o),i=t.pow(2,l),d=i*2,u=n-1,c;function f(w,x,_){var k=[];x=x==!0?{entropy:!0}:x||{};var P=C(E(x.entropy?[w,O(e)]:w??I(),3),k),N=new p(k),D=function(){for(var H=N.g(o),$=r,j=0;H<i;)H=(H+j)*n,$*=n,j=N.g(1);for(;H>=d;)H/=2,$/=2,j>>>=1;return(H+j)/$};return D.int32=function(){return N.g(4)|0},D.quick=function(){return N.g(4)/4294967296},D.double=D,C(O(N.S),e),(x.pass||_||function(H,$,j,M){return M&&(M.S&&y(M,N),H.state=function(){return y(N,{})}),j?(t[s]=H,$):H})(D,P,"global"in x?x.global:this==t,x.state)}function p(w){var x,_=w.length,k=this,P=0,N=k.i=k.j=0,D=k.S=[];for(_||(w=[_++]);P<n;)D[P]=P++;for(P=0;P<n;P++)D[P]=D[N=u&N+w[P%_]+(x=D[P])],D[N]=x;(k.g=function(H){for(var $,j=0,M=k.i,Y=k.j,Q=k.S;H--;)$=Q[M=u&M+1],j=j*n+Q[u&(Q[M]=Q[Y=u&Y+$])+(Q[Y]=$)];return k.i=M,k.j=Y,j})(n)}function y(w,x){return x.i=w.i,x.j=w.j,x.S=w.S.slice(),x}function E(w,x){var _=[],k=typeof w,P;if(x&&k=="object")for(P in w)try{_.push(E(w[P],x-1))}catch{}return _.length?_:k=="string"?w:w+"\0"}function C(w,x){for(var _=w+"",k,P=0;P<_.length;)x[u&P]=u&(k^=x[u&P]*19)+_.charCodeAt(P++);return O(x)}function I(){try{var w;return c&&(w=c.randomBytes)?w=w(n):(w=new Uint8Array(n),(a.crypto||a.msCrypto).getRandomValues(w)),O(w)}catch{var x=a.navigator,_=x&&x.plugins;return[+new Date,a,_,a.screen,O(e)]}}function O(w){return String.fromCharCode.apply(0,w)}if(C(t.random(),e),h.exports){h.exports=f;try{c=We}catch{}}else t["seed"+s]=f})(typeof self<"u"?self:St,[],Math)}(de)),de.exports}var Te,ze;function kt(){if(ze)return Te;ze=1;var h=ft(),a=pt(),e=gt(),t=wt(),n=Et(),o=vt(),l=At();return l.alea=h,l.xor128=a,l.xorwow=e,l.xorshift7=t,l.xor4096=n,l.tychei=o,Te=l,Te}var Tt=kt();const Ct=Ze(Tt),ce=["ability","able","aboard","about","above","accept","accident","according","account","accurate","acres","across","act","action","active","activity","actual","actually","add","addition","additional","adjective","adult","adventure","advice","affect","afraid","after","afternoon","again","against","age","ago","agree","ahead","aid","air","airplane","alike","alive","all","allow","almost","alone","along","aloud","alphabet","already","also","although","am","among","amount","ancient","angle","angry","animal","announced","another","answer","ants","any","anybody","anyone","anything","anyway","anywhere","apart","apartment","appearance","apple","applied","appropriate","are","area","arm","army","around","arrange","arrangement","arrive","arrow","art","article","as","aside","ask","asleep","at","ate","atmosphere","atom","atomic","attached","attack","attempt","attention","audience","author","automobile","available","average","avoid","aware","away","baby","back","bad","badly","bag","balance","ball","balloon","band","bank","bar","bare","bark","barn","base","baseball","basic","basis","basket","bat","battle","be","bean","bear","beat","beautiful","beauty","became","because","become","becoming","bee","been","before","began","beginning","begun","behavior","behind","being","believed","bell","belong","below","belt","bend","beneath","bent","beside","best","bet","better","between","beyond","bicycle","bigger","biggest","bill","birds","birth","birthday","bit","bite","black","blank","blanket","blew","blind","block","blood","blow","blue","board","boat","body","bone","book","border","born","both","bottle","bottom","bound","bow","bowl","box","boy","brain","branch","brass","brave","bread","break","breakfast","breath","breathe","breathing","breeze","brick","bridge","brief","bright","bring","broad","broke","broken","brother","brought","brown","brush","buffalo","build","building","built","buried","burn","burst","bus","bush","business","busy","but","butter","buy","by","cabin","cage","cake","call","calm","came","camera","camp","can","canal","cannot","cap","capital","captain","captured","car","carbon","card","care","careful","carefully","carried","carry","case","cast","castle","cat","catch","cattle","caught","cause","cave","cell","cent","center","central","century","certain","certainly","chain","chair","chamber","chance","change","changing","chapter","character","characteristic","charge","chart","check","cheese","chemical","chest","chicken","chief","child","children","choice","choose","chose","chosen","church","circle","circus","citizen","city","class","classroom","claws","clay","clean","clear","clearly","climate","climb","clock","close","closely","closer","cloth","clothes","clothing","cloud","club","coach","coal","coast","coat","coffee","cold","collect","college","colony","color","column","combination","combine","come","comfortable","coming","command","common","community","company","compare","compass","complete","completely","complex","composed","composition","compound","concerned","condition","congress","connected","consider","consist","consonant","constantly","construction","contain","continent","continued","contrast","control","conversation","cook","cookies","cool","copper","copy","corn","corner","correct","correctly","cost","cotton","could","count","country","couple","courage","course","court","cover","cow","cowboy","crack","cream","create","creature","crew","crop","cross","crowd","cry","cup","curious","current","curve","customs","cut","cutting","daily","damage","dance","danger","dangerous","dark","darkness","date","daughter","dawn","day","dead","deal","dear","death","decide","declared","deep","deeply","deer","definition","degree","depend","depth","describe","desert","design","desk","detail","determine","develop","development","diagram","diameter","did","die","differ","difference","different","difficult","difficulty","dig","dinner","direct","direction","directly","dirt","dirty","disappear","discover","discovery","discuss","discussion","disease","dish","distance","distant","divide","division","do","doctor","does","dog","doing","doll","dollar","done","donkey","door","dot","double","doubt","down","dozen","draw","drawn","dream","dress","drew","dried","drink","drive","driven","driver","driving","drop","dropped","drove","dry","duck","due","dug","dull","during","dust","duty","each","eager","ear","earlier","early","earn","earth","easier","easily","east","easy","eat","eaten","edge","education","effect","effort","egg","eight","either","electric","electricity","element","elephant","eleven","else","empty","end","enemy","energy","engine","engineer","enjoy","enough","enter","entire","entirely","environment","equal","equally","equator","equipment","escape","especially","essential","establish","even","evening","event","eventually","ever","every","everybody","everyone","everything","everywhere","evidence","exact","exactly","examine","example","excellent","except","exchange","excited","excitement","exciting","exclaimed","exercise","exist","expect","experience","experiment","explain","explanation","explore","express","expression","extra","eye","face","facing","fact","factor","factory","failed","fair","fairly","fall","fallen","familiar","family","famous","far","farm","farmer","farther","fast","fastened","faster","fat","father","favorite","fear","feathers","feature","fed","feed","feel","feet","fell","fellow","felt","fence","few","fewer","field","fierce","fifteen","fifth","fifty","fight","fighting","figure","fill","film","final","finally","find","fine","finest","finger","finish","fire","fireplace","firm","first","fish","five","fix","flag","flame","flat","flew","flies","flight","floating","floor","flow","flower","fly","fog","folks","follow","food","foot","football","for","force","foreign","forest","forget","forgot","forgotten","form","former","fort","forth","forty","forward","fought","found","four","fourth","fox","frame","free","freedom","frequently","fresh","friend","friendly","frighten","frog","from","front","frozen","fruit","fuel","full","fully","fun","function","funny","fur","furniture","further","future","gain","game","garage","garden","gas","gasoline","gate","gather","gave","general","generally","gentle","gently","get","getting","giant","gift","girl","give","given","giving","glad","glass","globe","go","goes","gold","golden","gone","good","goose","got","government","grabbed","grade","gradually","grain","grandfather","grandmother","graph","grass","gravity","gray","great","greater","greatest","greatly","green","grew","ground","group","grow","grown","growth","guard","guess","guide","gulf","gun","habit","had","hair","half","halfway","hall","hand","handle","handsome","hang","happen","happened","happily","happy","harbor","hard","harder","hardly","has","hat","have","having","hay","he","headed","heading","health","heard","hearing","heart","heat","heavy","height","held","hello","help","helpful","her","herd","here","herself","hidden","hide","high","higher","highest","highway","hill","him","himself","his","history","hit","hold","hole","hollow","home","honor","hope","horn","horse","hospital","hot","hour","house","how","however","huge","human","hundred","hung","hungry","hunt","hunter","hurried","hurry","hurt","husband","ice","idea","identity","if","ill","image","imagine","immediately","importance","important","impossible","improve","in","inch","include","including","income","increase","indeed","independent","indicate","individual","industrial","industry","influence","information","inside","instance","instant","instead","instrument","interest","interior","into","introduced","invented","involved","iron","is","island","it","its","itself","jack","jar","jet","job","join","joined","journey","joy","judge","jump","jungle","just","keep","kept","key","kids","kill","kind","kitchen","knew","knife","know","knowledge","known","label","labor","lack","lady","laid","lake","lamp","land","language","large","larger","largest","last","late","later","laugh","law","lay","layers","lead","leader","leaf","learn","least","leather","leave","leaving","led","left","leg","length","lesson","let","letter","level","library","lie","life","lift","light","like","likely","limited","line","lion","lips","liquid","list","listen","little","live","living","load","local","locate","location","log","lonely","long","longer","look","loose","lose","loss","lost","lot","loud","love","lovely","low","lower","luck","lucky","lunch","lungs","lying","machine","machinery","mad","made","magic","magnet","mail","main","mainly","major","make","making","man","managed","manner","manufacturing","many","map","mark","market","married","mass","massage","master","material","mathematics","matter","may","maybe","me","meal","mean","means","meant","measure","meat","medicine","meet","melted","member","memory","men","mental","merely","met","metal","method","mice","middle","might","mighty","mile","military","milk","mill","mind","mine","minerals","minute","mirror","missing","mission","mistake","mix","mixture","model","modern","molecular","moment","money","monkey","month","mood","moon","more","morning","most","mostly","mother","motion","motor","mountain","mouse","mouth","move","movement","movie","moving","mud","muscle","music","musical","must","my","myself","mysterious","nails","name","nation","national","native","natural","naturally","nature","near","nearby","nearer","nearest","nearly","necessary","neck","needed","needle","needs","negative","neighbor","neighborhood","nervous","nest","never","new","news","newspaper","next","nice","night","nine","no","nobody","nodded","noise","none","noon","nor","north","nose","not","note","noted","nothing","notice","noun","now","number","numeral","nuts","object","observe","obtain","occasionally","occur","ocean","of","off","offer","office","officer","official","oil","old","older","oldest","on","once","one","only","onto","open","operation","opinion","opportunity","opposite","or","orange","orbit","order","ordinary","organization","organized","origin","original","other","ought","our","ourselves","out","outer","outline","outside","over","own","owner","oxygen","pack","package","page","paid","pain","paint","pair","palace","pale","pan","paper","paragraph","parallel","parent","park","part","particles","particular","particularly","partly","parts","party","pass","passage","past","path","pattern","pay","peace","pen","pencil","people","per","percent","perfect","perfectly","perhaps","period","person","personal","pet","phrase","physical","piano","pick","picture","pictured","pie","piece","pig","pile","pilot","pine","pink","pipe","pitch","place","plain","plan","plane","planet","planned","planning","plant","plastic","plate","plates","play","pleasant","please","pleasure","plenty","plural","plus","pocket","poem","poet","poetry","point","pole","police","policeman","political","pond","pony","pool","poor","popular","population","porch","port","position","positive","possible","possibly","post","pot","potatoes","pound","pour","powder","power","powerful","practical","practice","prepare","present","president","press","pressure","pretty","prevent","previous","price","pride","primitive","principal","principle","printed","private","prize","probably","problem","process","produce","product","production","program","progress","promised","proper","properly","property","protection","proud","prove","provide","public","pull","pupil","pure","purple","purpose","push","put","putting","quarter","queen","question","quick","quickly","quiet","quietly","quite","rabbit","race","radio","railroad","rain","raise","ran","ranch","range","rapidly","rate","rather","raw","rays","reach","read","reader","ready","real","realize","rear","reason","recall","receive","recent","recently","recognize","record","red","refer","refused","region","regular","related","relationship","religious","remain","remarkable","remember","remove","repeat","replace","replied","report","represent","require","research","respect","rest","result","return","review","rhyme","rhythm","rice","rich","ride","riding","right","ring","rise","rising","river","road","roar","rock","rocket","rocky","rod","roll","roof","room","root","rope","rose","rough","round","route","row","rubbed","rubber","rule","ruler","run","running","rush","sad","saddle","safe","safety","said","sail","sale","salmon","salt","same","sand","sang","sat","satellites","satisfied","save","saved","saw","say","scale","scared","scene","school","science","scientific","scientist","score","screen","sea","search","season","seat","second","secret","section","see","seed","seeing","seems","seen","seldom","select","selection","sell","send","sense","sent","sentence","separate","series","serious","serve","service","sets","setting","settle","settlers","seven","several","shade","shadow","shake","shaking","shall","shallow","shape","share","sharp","she","sheep","sheet","shelf","shells","shelter","shine","shinning","ship","shirt","shoe","shoot","shop","shore","short","shorter","shot","should","shoulder","shout","show","shown","shut","sick","sides","sight","sign","signal","silence","silent","silk","silly","silver","similar","simple","simplest","simply","since","sing","single","sink","sister","sit","sitting","situation","six","size","skill","skin","sky","slabs","slave","sleep","slept","slide","slight","slightly","slip","slipped","slope","slow","slowly","small","smaller","smallest","smell","smile","smoke","smooth","snake","snow","so","soap","social","society","soft","softly","soil","solar","sold","soldier","solid","solution","solve","some","somebody","somehow","someone","something","sometime","somewhere","son","song","soon","sort","sound","source","south","southern","space","speak","special","species","specific","speech","speed","spell","spend","spent","spider","spin","spirit","spite","split","spoken","sport","spread","spring","square","stage","stairs","stand","standard","star","stared","start","state","statement","station","stay","steady","steam","steel","steep","stems","step","stepped","stick","stiff","still","stock","stomach","stone","stood","stop","stopped","store","storm","story","stove","straight","strange","stranger","straw","stream","street","strength","stretch","strike","string","strip","strong","stronger","struck","structure","struggle","stuck","student","studied","studying","subject","substance","success","successful","such","sudden","suddenly","sugar","suggest","suit","sum","summer","sun","sunlight","supper","supply","support","suppose","sure","surface","surprise","surrounded","swam","sweet","swept","swim","swimming","swing","swung","syllable","symbol","system","table","tail","take","taken","tales","talk","tall","tank","tape","task","taste","taught","tax","tea","teach","teacher","team","tears","teeth","telephone","television","tell","temperature","ten","tent","term","terrible","test","than","thank","that","thee","them","themselves","then","theory","there","therefore","these","they","thick","thin","thing","think","third","thirty","this","those","thou","though","thought","thousand","thread","three","threw","throat","through","throughout","throw","thrown","thumb","thus","thy","tide","tie","tight","tightly","till","time","tin","tiny","tip","tired","title","to","tobacco","today","together","told","tomorrow","tone","tongue","tonight","too","took","tool","top","topic","torn","total","touch","toward","tower","town","toy","trace","track","trade","traffic","trail","train","transportation","trap","travel","treated","tree","triangle","tribe","trick","tried","trip","troops","tropical","trouble","truck","trunk","truth","try","tube","tune","turn","twelve","twenty","twice","two","type","typical","uncle","under","underline","understanding","unhappy","union","unit","universe","unknown","unless","until","unusual","up","upon","upper","upward","us","use","useful","using","usual","usually","valley","valuable","value","vapor","variety","various","vast","vegetable","verb","vertical","very","vessels","victory","view","village","visit","visitor","voice","volume","vote","vowel","voyage","wagon","wait","walk","wall","want","war","warm","warn","was","wash","waste","watch","water","wave","way","we","weak","wealth","wear","weather","week","weigh","weight","welcome","well","went","were","west","western","wet","whale","what","whatever","wheat","wheel","when","whenever","where","wherever","whether","which","while","whispered","whistle","white","who","whole","whom","whose","why","wide","widely","wife","wild","will","willing","win","wind","window","wing","winter","wire","wise","wish","with","within","without","wolf","women","won","wonder","wonderful","wood","wooden","wool","word","wore","work","worker","world","worried","worry","worse","worth","would","wrapped","write","writer","writing","written","wrong","wrote","yard","year","yellow","yes","yesterday","yet","you","young","younger","your","yourself","youth","zero","zebra","zipper","zoo","zulu"],Ce=ce.reduce((h,a)=>a.length<h.length?a:h).length,Be=ce.reduce((h,a)=>a.length>h.length?a:h).length;function Bt(h){const a=h!=null&&h.seed?new Ct(h.seed):null,{minLength:e,maxLength:t,...n}=h||{};function o(){let f=typeof e!="number"?Ce:s(e);const p=typeof t!="number"?Be:s(t);f>p&&(f=p);let y=!1,E;for(;!y;)E=l(),y=E.length<=p&&E.length>=f;return E}function l(){return ce[r(ce.length)]}function s(f){return f<Ce&&(f=Ce),f>Be&&(f=Be),f}function r(f){const p=a?a():Math.random();return Math.floor(p*f)}if(h===void 0)return o();if(typeof h=="number")h={exactly:h};else if(Object.keys(n).length===0)return o();h.exactly&&(h.min=h.exactly,h.max=h.exactly),typeof h.wordsPerString!="number"&&(h.wordsPerString=1),typeof h.formatter!="function"&&(h.formatter=f=>f),typeof h.separator!="string"&&(h.separator=" ");const i=h.min+r(h.max+1-h.min);let d=[],u="",c=0;for(let f=0;f<i*h.wordsPerString;f++)c===h.wordsPerString-1?u+=h.formatter(o(),c):u+=h.formatter(o(),c)+h.separator,c++,(f+1)%h.wordsPerString===0&&(d.push(u),u="",c=0);return typeof h.join=="string"&&(d=d.join(h.join)),d}class Ye{validatePassphrase(a){if(a!=null&&a.length<8)throw new Error("Passphrase must be at least 8 characters")}arrayBufferToHex(a){return Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")}hexToArrayBuffer(a){const e=new Uint8Array(a.length/2);for(let t=0;t<a.length;t+=2)e[t/2]=parseInt(a.slice(t,t+2),16);return e.buffer}async generateRandomString(a){const t=await new ke().getRandomBytes(a);return this.arrayBufferToHex(t)}generatePasssphrase(){return Bt({exactly:8,join:"-"})}async encryptMessage(a,e=null){this.validatePassphrase(e);const t=new ke;e=e||this.generatePasssphrase();const n=await t.getRandomBytes(8),o=await t.derivePassphraseKey(e,n,64e3);var l=new TextEncoder;const s=await t.encrypt(o,l.encode(a)),r=this.arrayBufferToHex(n)+s;return{passphrase:e,secret:r}}async decryptMessage(a,e){try{this.validatePassphrase(e);const n=new ke,o=this.hexToArrayBuffer(a.slice(0,16));a=a.slice(16);const l=await n.derivePassphraseKey(e,o,64e3);var t=new TextDecoder;const s=await n.decrypt(l,a),r=t.decode(s);if((r==null?void 0:r.length)>0)return r;throw new Error}catch{throw new Error("Could not decrypt message. Password might be wrong. Message destroyed.")}}}const Pt={class:"mt-5 md:mt-0 md:col-span-2 opacity-95"},_t={class:"grid grid-cols-6 gap-6"},Ot={key:0,class:"flex items-center justify-end px-4 py-3 bg-gray-50 dark:bg-gray-800 text-end sm:px-6 shadow sm:rounded-bl-md sm:rounded-br-md"},It={__name:"FlatFormSection",emits:["submitted"],setup(h){const a=Z(()=>!!Je().actions);return(e,t)=>(b(),T("div",Pt,[g("form",{onSubmit:t[0]||(t[0]=re(n=>e.$emit("submitted"),["prevent"]))},[g("div",{class:G(["px-4 py-5 bg-gray-50 dark:bg-gray-900 sm:p-6 shadow",a.value?"sm:rounded-tl-md sm:rounded-tr-md":"sm:rounded-md"])},[g("div",_t,[z(e.$slots,"form")])],2),a.value?(b(),T("div",Ot,[z(e.$slots,"actions")])):K("",!0)],32)]))}},Nt={},Ht={class:"mt-5 md:mt-0 md:col-span-2 opacity-95"},Dt={class:"px-4 py-5 sm:p-6 bg-white dark:bg-gray-900 shadow sm:rounded-lg"};function jt(h,a){return b(),T("div",Ht,[g("div",Dt,[z(h.$slots,"default")])])}const Rt=st(Nt,[["render",jt]]),Kt={class:"my-4"},$t={class:"text-lg font-bold dark:text-white"},q={__name:"Faq",props:{question:String,message:String},setup(h){return(a,e)=>(b(),T("div",Kt,[g("h6",$t,U(h.question),1),g("span",null,[z(a.$slots,"default")])]))}},Lt=["value"],qt=["value"],Ut={__name:"SelectInput",props:{modelValue:String,options:Array},emits:["update:modelValue"],setup(h,{expose:a}){const e=F(null);return _e(()=>{e.value.hasAttribute("autofocus")&&e.value.focus()}),a({focus:()=>e.value.focus()}),(t,n)=>(b(),T("select",{ref_key:"input",ref:e,class:"border-gray-300 dark:border-gray-700 dark:bg-gray-700 dark:text-gray-200 focus:border-gray-500 dark:focus:border-gray-600 focus:ring-gray-500 dark:focus:ring-gray-600 rounded-md shadow-sm",value:h.modelValue,onInput:n[0]||(n[0]=o=>t.$emit("update:modelValue",o.target.value))},[(b(!0),T(ue,null,et(h.options,o=>(b(),T("option",{key:o,value:o.value},U(o.label),9,qt))),128))],40,Lt))}},Mt={class:"w-full"},Ft={class:"relative"},Gt={key:0,id:"default-icon"},Vt={key:1,id:"success-icon",class:"inline-flex items-center"},Xe={__name:"CodeBlock",props:{value:String},setup(h){const a=h,e=F(null),t=F(!1),n=o=>{navigator.clipboard.writeText(o),t.value=!0,setTimeout(()=>t.value=!1,1e3)};return(o,l)=>(b(),T("div",Mt,[g("div",Ft,[l[3]||(l[3]=g("label",{for:"npm-install-copy-button",class:"sr-only"},"Label",-1)),g("code",{ref_key:"text",ref:e,class:"col-span-6 bg-gray-50 border border-gray-300 text-gray-500 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",disabled:"",readonly:""},[z(o.$slots,"default",{},()=>[S(U(a.value),1)])],512),g("button",{type:"button",onClick:l[0]||(l[0]=re(s=>n(e.value.innerText),["prevent"])),"data-tooltip-target":"tooltip-copy-npm-install-copy-button",class:"absolute end-2 bottom-1 translate-y-1 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg p-1 mb-1 inline-flex items-center justify-center hover:text-gray-900 dark:hover:text-white"},[t.value?K("",!0):(b(),T("span",Gt,l[1]||(l[1]=[g("svg",{class:"w-3.5 h-3.5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 18 20"},[g("path",{d:"M16 1h-3.278A1.992 1.992 0 0 0 11 0H7a1.993 1.993 0 0 0-1.722 1H2a2 2 0 0 0-2 2v15a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2Zm-3 14H5a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2Zm0-4H5a1 1 0 0 1 0-2h8a1 1 0 1 1 0 2Zm0-5H5a1 1 0 0 1 0-2h2V2h4v2h2a1 1 0 1 1 0 2Z"})],-1)]))),t.value?(b(),T("span",Vt,l[2]||(l[2]=[g("svg",{class:"w-3.5 h-3.5 text-blue-700 dark:text-blue-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 12"},[g("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M1 5.917 5.724 10.5 15 1.5"})],-1)]))):K("",!0)]),l[4]||(l[4]=g("div",{id:"tooltip-copy-npm-install-copy-button",role:"tooltip",class:"absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700"},[g("span",{id:"default-tooltip-message"},"Copy to clipboard"),g("span",{id:"success-tooltip-message",class:"hidden"},"Copied!"),g("div",{class:"tooltip-arrow","data-popper-arrow":""})],-1))])]))}},Qt={class:"sr-only"},zt={key:0,class:"font-medium"},Yt={class:"pl-6"},Pe={__name:"Alert",props:{type:{type:String,default:"info"},message:{type:String,default:""},hideTitle:{type:Boolean,default:!1}},setup(h){const a=h,e={"flex items-center p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400":a.type=="Success","flex items-center p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400":a.type=="Error","flex items-center p-4 mb-4 text-sm text-yellow-800 rounded-lg bg-yellow-50 dark:bg-gray-800 dark:text-yellow-300":a.type=="Warning","flex items-center p-4 mb-4 text-sm text-blue-800 rounded-lg bg-blue-50 dark:bg-gray-800 dark:text-blue-400":a.type=="Info"};return(t,n)=>(b(),T("div",{class:G([e,"relative"]),role:"alert"},[n[1]||(n[1]=g("svg",{class:"absolute top-5 flex-shrink-0 inline w-4 h-4 me-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[g("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1)),g("span",Qt,U(a.type),1),g("div",null,[h.hideTitle?K("",!0):(b(),T("span",zt,U(a.type),1)),n[0]||(n[0]=S()),g("div",Yt,[z(t.$slots,"default",{},()=>[S(U(a.message),1)])])])]))}},Xt={class:"col-span-12"},Wt={key:0,class:"col-span-12"},Zt={class:"col-span-12"},Jt={class:"col-span-12"},er={class:"flex flex-wrap sm:flex-nowrap gap-2 sm:space-y-0 sm:space-y-0"},tr={key:0,class:"w-full"},rr={key:1},ar={key:0},nr={key:1},sr=["href"],or={__name:"Secret",props:{secret:{type:String,default:null},decryptUrl:{type:String,default:null}},setup(h){const a=L().props.config.secrets.expiry,e=()=>{o.message="",o.expires_in=a,s.password=null,tt.reload()},t=h,n=F(null),o=fe({message:t.secret?"This isnt the actual messageits just a placeholder. To view the message, please click the button below.":"",expires_in:L().props.config.secrets.expiry}),l=fe({}),s=fe({password:null}),r=F(!1),i=Z(()=>{var p,y;return t.secret&&(!((y=(p=L().props.jetstream.flash)==null?void 0:p.secret)!=null&&y.message)||r.value===!1)?"mt-1 block w-full blur-sm":"mt-1 block w-full"}),d=p=>{switch(p.code){case 429:return"Wow! Too many requests too fast, pace yourselves. Please try again in a minute. We will soon introduce user accounts with a higher rate limit.";default:return p.message}},u=()=>{new Ye().encryptMessage(o.message,s.password).then(y=>{o.transform(E=>({...E,message:y.secret})).post(route("secret.store"),{preserveScroll:!0,onSuccess:()=>{var E;if((E=L().props.jetstream.flash)!=null&&E.error){o.setError("message",d(L().props.jetstream.flash.error));return}y.passphrase!=s.password&&(s.password=y.passphrase)}})}).catch(y=>{s.setError("password",y.message)})},c=Z(()=>t.secret==null?"Enter a passsword, or leave blank to auto generate a password for you.":"Enter your password to decrypt the message.");F(!1),Z(()=>{var p,y,E,C;return L().props.config.secrets.message_length[(E=(y=(p=L().props)==null?void 0:p.auth)==null?void 0:y.user)!=null&&E.id?"user":"guest"]-((C=o.message)==null?void 0:C.length)});const f=()=>{const p=new Ye;l.get(t.decryptUrl,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{var y,E,C;if(!((y=L().props.jetstream.flash)!=null&&y.error)&&((C=(E=L().props.jetstream.flash)==null?void 0:E.error)==null?void 0:C.code)!=404){const I=L().props.jetstream.flash.secret.message,O=s.password;p.decryptMessage(I,O).then(w=>{o.message=w,r.value=!0}).catch(w=>{o.setError("message",w)})}},onError:()=>{o.setError("message","Could not get your message. Either the password was wrong, or the message is already expired, or the message was already retrieved. You have no more attempts.")}})};return(p,y)=>{var E,C;return b(),T(ue,null,[B(It,null,{title:A(()=>y[3]||(y[3]=[S(" FlashView ")])),form:A(()=>{var I,O,w,x,_,k,P,N,D,H,$,j,M,Y,Q,Oe;return[g("div",Xt,[t.secret!=null?(b(),R(Pe,{key:0,type:"Warning","hide-title":""},{default:A(()=>y[4]||(y[4]=[g("div",{class:"mb-2"},[S(" You can attempt to retrieve this message "),g("span",{class:"relative inline-block"},[S(" ONLY ONCE "),g("svg",{class:"underline-svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 300 20"},[g("path",{d:"M0 15 Q150 -10 300 15"})])]),S(". ")],-1),g("ol",{class:"space-y-1 list-decimal list-inside"},[g("li",null,"Wrong password will result in the message being deleted."),g("li",null,"Correct password will show the message, and the message will be deleted."),g("li",null,"Message will be deleted after the expiration time.")],-1)])),_:1})):K("",!0),((I=p.$page.props.jetstream.flash.error)==null?void 0:I.code)==404?(b(),R(Pe,{key:1,"hide-title":"",type:"Error"},{default:A(()=>y[5]||(y[5]=[S(" This message has expired or has already been retrieved. ")])),_:1})):K("",!0)]),(w=(O=p.$page.props.jetstream.flash)==null?void 0:O.secret)!=null&&w.url?(b(),T("div",Wt,[B(Pe,{"hide-title":"",type:"Success"},{default:A(()=>y[6]||(y[6]=[S(" Please share the link and password separately to the recipient. The message can be retrieved only once and only with both the link and the password. If you wish to prematurely delete the message, you may visit the link and enter any random password and click retrieve. ")])),_:1})])):K("",!0),g("div",Zt,[(_=(x=p.$page.props.jetstream.flash)==null?void 0:x.secret)!=null&&_.url?(b(),R(Xe,{key:0,value:(P=(k=p.$page.props.jetstream.flash)==null?void 0:k.secret)==null?void 0:P.url,class:"break-words"},null,8,["value"])):(b(),R(ut,{key:1,autofocus:t.secret==null,id:"message",rows:"7",modelValue:v(o).message,"onUpdate:modelValue":y[0]||(y[0]=J=>v(o).message=J),type:"text",class:G(i.value),placeholder:"Your secret message...","max-length":v(L)().props.config.secrets.message_length[(H=(D=(N=v(L)().props)==null?void 0:N.auth)==null?void 0:D.user)!=null&&H.id?"user":"guest"]},null,8,["autofocus","modelValue","class","max-length"])),y[7]||(y[7]=g("div",{class:"flex flex-wrap mt-2 relative"},[g("div",{class:"flex flex-wrap"},[g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"size-4"},[g("path",{"fill-rule":"evenodd",d:"M12 1.5a5.25 5.25 0 0 0-5.25 5.25v3a3 3 0 0 0-3 3v6.75a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3v-6.75a3 3 0 0 0-3-3v-3c0-2.9-2.35-5.25-5.25-5.25Zm3.75 8.25v-3a3.75 3.75 0 1 0-7.5 0v3h7.5Z","clip-rule":"evenodd"})]),g("div",{class:"ml-1 text-sm"},"End-to-end encrypted")])],-1)),B(pe,{message:v(o).errors.message,class:"mt-2"},null,8,["message"])]),g("div",Jt,[g("div",er,[((j=($=p.$page.props.jetstream.flash)==null?void 0:$.secret)==null?void 0:j.message)==null?(b(),T("div",tr,[(Y=(M=p.$page.props.jetstream.flash)==null?void 0:M.secret)!=null&&Y.url?(b(),R(Xe,{key:0,value:v(s).password},null,8,["value"])):(b(),R(nt,{key:1,id:"password",autofocus:t.secret!=null,ref_key:"passwordInput",ref:n,modelValue:v(s).password,"onUpdate:modelValue":y[1]||(y[1]=J=>v(s).password=J),type:"text",class:"mt-1 block w-full",placeholder:c.value},null,8,["autofocus","modelValue","placeholder"])),B(pe,{message:v(s).errors.password,class:"mt-2"},null,8,["message"])])):K("",!0),!((Oe=(Q=p.$page.props.jetstream.flash)==null?void 0:Q.secret)!=null&&Oe.url)&&t.secret==null?(b(),T("div",rr,[B(Ut,{id:"expires_in",modelValue:v(o).expires_in,"onUpdate:modelValue":y[2]||(y[2]=J=>v(o).expires_in=J),class:"mt-1 sm:w-full",options:p.$page.props.config.secrets.expiry_options},null,8,["modelValue","options"]),B(pe,{message:v(s).errors.expires_in,class:"mt-2"},null,8,["message"])])):K("",!0)])])]}),actions:A(()=>{var I,O,w,x,_,k;return[t.secret==null?(b(),T("span",ar,[(O=(I=p.$page.props.jetstream.flash)==null?void 0:I.secret)!=null&&O.url?(b(),R(he,{key:0,onClick:re(e,["prevent"]),class:G({"opacity-25":v(o).processing}),disabled:v(o).processing},{default:A(()=>y[8]||(y[8]=[S(" Let's do another one ")])),_:1},8,["class","disabled"])):(b(),R(he,{key:1,onClick:re(u,["prevent"]),class:G({"opacity-25":v(o).processing}),disabled:v(o).processing},{default:A(()=>y[9]||(y[9]=[S(" Generate link ")])),_:1},8,["class","disabled"]))])):(b(),T("span",nr,[(x=(w=p.$page.props.jetstream.flash)==null?void 0:w.secret)!=null&&x.message?(b(),R(v(te),{key:1,href:p.route("welcome"),class:"inline-flex items-center px-4 py-2 bg-gamboge-800 dark:bg-gamboge-200 border border-transparent rounded-md font-semibold text-xs text-white dark:text-gamboge-800 uppercase tracking-widest hover:bg-gamboge-700 dark:hover:bg-white focus:bg-gamboge-700 dark:focus:bg-white active:bg-gamboge-900 dark:active:bg-gamboge-300 focus:outline-none focus:ring-2 focus:ring-gamboge-500 focus:ring-offset-2 dark:focus:ring-offset-gamboge-800 disabled:opacity-50 transition ease-in-out duration-150"},{default:A(()=>y[11]||(y[11]=[S(" Send a new secret link ")])),_:1},8,["href"])):(b(),R(he,{key:0,onClick:re(f,["prevent"]),class:G({"opacity-25":v(l).processing||((_=v(s).password)==null?void 0:_.length)==0||v(s).password==null}),disabled:v(l).processing||((k=v(s).password)==null?void 0:k.length)==0||v(s).password==null},{default:A(()=>y[10]||(y[10]=[S(" Retrieve Message ")])),_:1},8,["class","disabled"]))]))]}),_:1}),(C=(E=p.$page.props.jetstream.flash)==null?void 0:E.secret)!=null&&C.url?K("",!0):(b(),R(Rt,{key:0,class:"pt-4"},{default:A(()=>[y[22]||(y[22]=g("h2",{class:"text-4xl font-extrabold dark:text-white"},"F.A.Q.",-1)),B(q,{question:"How safe is sharing a secret with "+p.$page.props.config.app.name+" ?"},{default:A(()=>[S(" The secret message is encrypted on your browser. The passphrase and the plaintext secret message is never sent to "+U(p.$page.props.config.app.name)+". Only the encrypted message is sent to the server. So we have no means to decrypt the message. For the same reason, a hacker who gains complete access to all our systems will still not be able to decode the secret message. ",1)]),_:1},8,["question"]),B(q,{question:"How do you compare with other providers, like onetimesecret.com?"},{default:A(()=>[S(" Most other providers like onetimesecret.com send the secret and password as plaintext to the server and the server does the encryption. Though the good people at onetimesecret.com do not misuse this, a man in the middle could still grab the secret message. "+U(p.$page.props.config.app.name)+" encrypts the message on your browser before sending it to the server. This way we, or a man in the middle, do not know what the secret is or what the passphrase to decrypt it is. ",1)]),_:1}),B(q,{question:"How secure is the encryption?"},{default:A(()=>y[12]||(y[12]=[S(" The encryption is based on AES-256-GCM which is one for most secure encryption algorithms available to mankind. With the existing technology it will take millions of years for someone to crack the encryption. ")])),_:1}),B(q,{question:"Why don't you add the passphrase to the link like other providers?"},{default:A(()=>y[13]||(y[13]=[S(" While it is convinient for the end user to encode the passphrase into the link, it would also mean that our server receives the passphrase and so does a man in the middle. By not including the passphrase in the link, we have completely cut off ourselves and any man in the middle from being able to retrieve the secret message. ")])),_:1}),B(q,{question:"How do I delete the secret message?"},{default:A(()=>y[14]||(y[14]=[S(" The secret message is deleted when it reaches the expiry set while generating the secret link, or on the first attempt to retrieve the message - whichever comes first. If you wish to manually delete the secret before it is retrieved, you could just visit the same link and give any random password and press retrieve to delete the message. ")])),_:1}),B(q,{question:"How long will the secret be available?"},{default:A(()=>y[15]||(y[15]=[S(" The secret message is deleted when it reaches the expiry set while generating the secret link, or on the first attempt to retrieve the message - whichever comes first. ")])),_:1}),B(q,{question:"What would be some of the usecases?"},{default:A(()=>y[16]||(y[16]=[g("ul",{class:"list-disc list-inside"},[g("li",null,"For sending passwords, or share your Netflix credentials with familiy."),g("li",null,"To confess to your secret crush."),g("li",null,"Tell your kids about your grandfather's secret treasure stash."),g("li",null,"Literally anything...")],-1)])),_:1}),B(q,{question:"How do you avoid harrasment and other illegal use of the system?"},{default:A(()=>[S(" We log the IP address and the time at which a link is generated and retrieved. This log is kept for "+U(p.$page.props.config.secrets.prune_after)+" days after which they are permanently deleted as well. If a legal authority produces a court order to request details about a message, we will provide them with the IP address from which and the time at which the link was generated and accessed as long as it has not yet been pruned by the system. ",1)]),_:1}),B(q,{question:"Isn't that a privacy concern?"},{default:A(()=>y[17]||(y[17]=[S(" All secret messages are stored encrypted and encryption occurs at the browser before it is sent to us. So the content of the message is still secure and of no use to anyone except the recipient. We will not be able to retrieve the message content even if we wanted to. We will only share the metadata (IP address and time it was created, and the IP address and time it was retrieved) with legal authorities and only if they request it with a proper court order that relates to an investigation that is related to illegal use like harrasment or terrorism. In all other cases no metadata will be shared. ")])),_:1}),B(q,{question:"How are the metadata stored?"},{default:A(()=>y[18]||(y[18]=[S(' The IP Addresses is stored encrypted use AES-256-CBC algorithm with an "application key". This key is not stored in the database and is only stored on our application server. Hence a hack into our database will not reveal the metadata. The time at which a message was created or retrieved is not stored encrypted. ')])),_:1}),B(q,{question:"How can legal authorities contact you with a court order?"},{default:A(()=>[y[19]||(y[19]=S(" If you are a legal authority, you can email us at ")),g("a",{class:"underline text-gamboge-200",href:"mailto:"+p.$page.props.config.support.legal},U(p.$page.props.config.support.legal),9,sr),y[20]||(y[20]=S(". The request should have the retrieval URL for the message, a scanned copy of the notorised court order, and the reason for the request. To speed up the process (that is to help us validate the authority of the court order) we recommend that the email be sent from the registed domain name for the court or the legal authority and is signed using a valid digital signature. "))]),_:1}),B(q,{question:"Why is it rate limited?"},{default:A(()=>y[21]||(y[21]=[S(" We rate limit the number of times an anonymous user can generate links to avoid abuse. We will soon introduce user accounts which will allown you to generate more links per minute. ")])),_:1})]),_:1}))],64)}}},ir="/build/assets/logo-m6iWsb0r.png",lr={class:"w-full h-full flex justify-center items-center flex-wrap gap-2"},dr={class:"text-4xl font-bold"},ur={class:"text-gamboge-200 mr-2 border-r-2 animate-typing border-gamboge-200 pr-1"},cr={__name:"Typewriter",props:{phrases:{type:Array,required:!0},speed:{type:Number,default:100}},setup(h){const a=h,e=F(0),t=F(""),n=F(0),o=F(!1);return _e(()=>{setInterval(()=>{o.value?(t.value=a.phrases[e.value].substring(0,--n.value),n.value==0&&(o.value=!1,e.value=e.value+1,e.value==a.phrases.length&&(e.value=0))):(t.value=a.phrases[e.value].substring(0,++n.value),n.value==a.phrases[e.value].length+5&&(o.value=!0))},a.speed)}),(l,s)=>(b(),T("div",lr,[g("h1",dr,[z(l.$slots,"before"),g("span",ur,U(t.value),1),z(l.$slots,"after")])]))}},fr={class:"relative min-h-screen flex flex-col items-center justify-center"},hr={class:"relative w-full max-w-2xl px-6 lg:max-w-7xl"},pr={class:"grid grid-cols-2 items-center gap-2 py-10 lg:grid-cols-3"},yr={class:"flex lg:justify-center lg:col-start-2"},gr=["src"],mr={key:0,class:"-mx-3 flex flex-1 justify-end"},wr={class:"mt-6 grid-cols-1 gap-6 max-w-4xl mx-auto"},Sr={__name:"Welcome",props:{canLogin:{type:Boolean,default:!1},canRegister:{type:Boolean,default:!1},secret:{type:String,default:null},decryptUrl:{type:String,default:null}},setup(h){const a=Z(()=>"bg-gray-50 text-black/50 dark:bg-black dark:text-white/50 bg-cover ");return(e,t)=>(b(),T(ue,null,[B(v(at),{title:"Welcome"}),g("div",{class:G(a.value),style:rt({"background-image":`url(${v(ot)})`})},[g("div",fr,[g("div",hr,[g("header",pr,[g("div",yr,[B(v(te),{href:"/"},{default:A(()=>[g("img",{src:v(ir),class:"h-24 w-auto"},null,8,gr)]),_:1})]),h.canLogin?(b(),T("nav",mr,[e.$page.props.auth.user?(b(),R(v(te),{key:0,href:e.route("dashboard"),class:"rounded-md px-3 py-2 text-black ring-1 ring-transparent transition hover:text-black/70 focus:outline-none focus-visible:ring-[#FF2D20] dark:text-white dark:hover:text-white/80 dark:focus-visible:ring-white"},{default:A(()=>t[0]||(t[0]=[S(" Dashboard ")])),_:1},8,["href"])):(b(),T(ue,{key:1},[B(v(te),{href:e.route("login"),class:"rounded-md px-3 py-2 text-black ring-1 ring-transparent transition hover:text-black/70 focus:outline-none focus-visible:ring-[#FF2D20] dark:text-white dark:hover:text-white/80 dark:focus-visible:ring-white"},{default:A(()=>t[1]||(t[1]=[S(" Log in ")])),_:1},8,["href"]),h.canRegister?(b(),R(v(te),{key:0,href:e.route("register"),class:"rounded-md px-3 py-2 text-black ring-1 ring-transparent transition hover:text-black/70 focus:outline-none focus-visible:ring-[#FF2D20] dark:text-white dark:hover:text-white/80 dark:focus-visible:ring-white"},{default:A(()=>t[2]||(t[2]=[S(" Register ")])),_:1},8,["href"])):K("",!0)],64))])):K("",!0)]),g("main",wr,[B(cr,{class:"text-gray-200 dark:text-white mb-6",phrases:["time-sensitive.","one-time use.","disposable."],speed:100},{before:A(()=>t[3]||(t[3]=[S(" Keep sensitive information out of your email and chat logs with links that are ")])),_:1}),B(or,{secret:h.secret,"decrypt-url":h.decryptUrl},null,8,["secret","decrypt-url"])]),t[4]||(t[4]=g("footer",{class:"py-16 text-center text-sm text-black dark:text-white/70"},null,-1))])])],6)],64))}};export{Sr as default};
